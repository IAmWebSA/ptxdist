# 
# Submitted:
#
# Robert Schwebel, 2004-08-18
#
# Error: 
#
# when cross compiling, wrong libpng-config is called (development host,
# not that one for the target) 
#
# Description: 
#
# - not avialable
#
# State:
# 
# - to be sent upstream
#

diff -urN gnuplot-4.0.0-orig/configure gnuplot-4.0.0/configure
--- gnuplot-4.0.0-orig/configure	2004-04-13 19:10:35.000000000 +0200
+++ gnuplot-4.0.0/configure	2004-08-18 20:33:22.000000000 +0200
@@ -8850,9 +8850,9 @@
 fi
 
   if test -n "$LIBPNG_CONFIG"; then
-    libpng_CPPFLAGS=`libpng-config --cflags`
+    libpng_CPPFLAGS=`$LIBPNG_CONFIG --cflags`
     # should be --ldopts, but it's currently broken
-    libpng_LDFLAGS=`libpng-config --ldflags | sed 's/ -l[^ ][^ ]*//g'`
+    libpng_LDFLAGS=`$LIBPNG_CONFIG --ldflags`
   elif test -d "$with_png"; then
     libpng_CPPFLAGS="-I$with_png/include"
     libpng_LDFLAGS="-L$with_png/lib"

#
# This would be the "real" patch...
# 
#diff -urN gnuplot-4.0.0-orig/configure.in gnuplot-4.0.0/configure.in
#--- gnuplot-4.0.0-orig/configure.in	2004-04-10 17:55:14.000000000 +0200
#+++ gnuplot-4.0.0/configure.in	2004-08-18 20:33:49.000000000 +0200
#@@ -379,9 +379,9 @@
# if test "$with_png" != no; then
#   AC_PATH_PROG([LIBPNG_CONFIG], [libpng-config])
#   if test -n "$LIBPNG_CONFIG"; then
#-    libpng_CPPFLAGS=`libpng-config --cflags`
#+    libpng_CPPFLAGS=`$LIBPNG_CONFIG --cflags`
#     # should be --ldopts, but it's currently broken
#-    libpng_LDFLAGS=`libpng-config --ldflags | sed 's/ -l[[^ ]][[^ ]]*//g'`
#+    libpng_LDFLAGS=`$LIBPNG_CONFIG --ldflags | sed 's/ -l[[^ ]][[^ ]]*//g'`
#   elif test -d "$with_png"; then
#     libpng_CPPFLAGS="-I$with_png/include"
#     libpng_LDFLAGS="-L$with_png/lib"

--- gnuplot-4.0.0-orig/Makefile.in	2004-04-13 19:10:34.000000000 +0200
+++ gnuplot-4.0.0/Makefile.in	2004-08-18 20:44:47.000000000 +0200
@@ -130,7 +130,7 @@
 target_alias = @target_alias@
 AUTOMAKE_OPTIONS = foreign 1.2h
 
-SUBDIRS = config m4 term src docs lisp man demo tutorial
+SUBDIRS = config m4 term src lisp man demo tutorial
 
 EXTRA_DIST = BUGS CodeStyle Copyright FAQ GNUmakefile INSTALL INSTALL.gnu \
 Makefile.maint PATCHLEVEL PGPKEYS PORTING README README.1ST README.exp \
