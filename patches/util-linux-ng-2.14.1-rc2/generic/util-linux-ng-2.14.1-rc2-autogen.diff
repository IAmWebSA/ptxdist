diff -ur util-linux-ng-2.14.1-rc2-orig/aclocal.m4 util-linux-ng-2.14.1-rc2/aclocal.m4
--- util-linux-ng-2.14.1-rc2-orig/aclocal.m4	2008-08-22 13:07:54.000000000 +0200
+++ util-linux-ng-2.14.1-rc2/aclocal.m4	2008-09-03 10:34:21.000000000 +0200
@@ -19,6 +19,164 @@
 If you have problems, you may need to regenerate the build system entirely.
 To do so, use the procedure documented by the package, typically `autoreconf'.])])
 
+# pkg.m4 - Macros to locate and utilise pkg-config.            -*- Autoconf -*-
+# 
+# Copyright Â© 2004 Scott James Remnant <scott@netsplit.com>.
+#
+# This program is free software; you can redistribute it and/or modify
+# it under the terms of the GNU General Public License as published by
+# the Free Software Foundation; either version 2 of the License, or
+# (at your option) any later version.
+#
+# This program is distributed in the hope that it will be useful, but
+# WITHOUT ANY WARRANTY; without even the implied warranty of
+# MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
+# General Public License for more details.
+#
+# You should have received a copy of the GNU General Public License
+# along with this program; if not, write to the Free Software
+# Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA 02111-1307, USA.
+#
+# As a special exception to the GNU General Public License, if you
+# distribute this file as part of a program that contains a
+# configuration script generated by Autoconf, you may include it under
+# the same distribution terms that you use for the rest of that program.
+
+# PKG_PROG_PKG_CONFIG([MIN-VERSION])
+# ----------------------------------
+AC_DEFUN([PKG_PROG_PKG_CONFIG],
+[m4_pattern_forbid([^_?PKG_[A-Z_]+$])
+m4_pattern_allow([^PKG_CONFIG(_PATH)?$])
+AC_ARG_VAR([PKG_CONFIG], [path to pkg-config utility])dnl
+if test "x$ac_cv_env_PKG_CONFIG_set" != "xset"; then
+	AC_PATH_TOOL([PKG_CONFIG], [pkg-config])
+fi
+if test -n "$PKG_CONFIG"; then
+	_pkg_min_version=m4_default([$1], [0.9.0])
+	AC_MSG_CHECKING([pkg-config is at least version $_pkg_min_version])
+	if $PKG_CONFIG --atleast-pkgconfig-version $_pkg_min_version; then
+		AC_MSG_RESULT([yes])
+	else
+		AC_MSG_RESULT([no])
+		PKG_CONFIG=""
+	fi
+		
+fi[]dnl
+])# PKG_PROG_PKG_CONFIG
+
+# PKG_CHECK_EXISTS(MODULES, [ACTION-IF-FOUND], [ACTION-IF-NOT-FOUND])
+#
+# Check to see whether a particular set of modules exists.  Similar
+# to PKG_CHECK_MODULES(), but does not set variables or print errors.
+#
+#
+# Similar to PKG_CHECK_MODULES, make sure that the first instance of
+# this or PKG_CHECK_MODULES is called, or make sure to call
+# PKG_CHECK_EXISTS manually
+# --------------------------------------------------------------
+AC_DEFUN([PKG_CHECK_EXISTS],
+[AC_REQUIRE([PKG_PROG_PKG_CONFIG])dnl
+if test -n "$PKG_CONFIG" && \
+    AC_RUN_LOG([$PKG_CONFIG --exists --print-errors "$1"]); then
+  m4_ifval([$2], [$2], [:])
+m4_ifvaln([$3], [else
+  $3])dnl
+fi])
+
+
+# _PKG_CONFIG([VARIABLE], [COMMAND], [MODULES])
+# ---------------------------------------------
+m4_define([_PKG_CONFIG],
+[if test -n "$PKG_CONFIG"; then
+    if test -n "$$1"; then
+        pkg_cv_[]$1="$$1"
+    else
+        PKG_CHECK_EXISTS([$3],
+                         [pkg_cv_[]$1=`$PKG_CONFIG --[]$2 "$3" 2>/dev/null`],
+			 [pkg_failed=yes])
+    fi
+else
+	pkg_failed=untried
+fi[]dnl
+])# _PKG_CONFIG
+
+# _PKG_SHORT_ERRORS_SUPPORTED
+# -----------------------------
+AC_DEFUN([_PKG_SHORT_ERRORS_SUPPORTED],
+[AC_REQUIRE([PKG_PROG_PKG_CONFIG])
+if $PKG_CONFIG --atleast-pkgconfig-version 0.20; then
+        _pkg_short_errors_supported=yes
+else
+        _pkg_short_errors_supported=no
+fi[]dnl
+])# _PKG_SHORT_ERRORS_SUPPORTED
+
+
+# PKG_CHECK_MODULES(VARIABLE-PREFIX, MODULES, [ACTION-IF-FOUND],
+# [ACTION-IF-NOT-FOUND])
+#
+#
+# Note that if there is a possibility the first call to
+# PKG_CHECK_MODULES might not happen, you should be sure to include an
+# explicit call to PKG_PROG_PKG_CONFIG in your configure.ac
+#
+#
+# --------------------------------------------------------------
+AC_DEFUN([PKG_CHECK_MODULES],
+[AC_REQUIRE([PKG_PROG_PKG_CONFIG])dnl
+AC_ARG_VAR([$1][_CFLAGS], [C compiler flags for $1, overriding pkg-config])dnl
+AC_ARG_VAR([$1][_LIBS], [linker flags for $1, overriding pkg-config])dnl
+
+pkg_failed=no
+AC_MSG_CHECKING([for $1])
+
+_PKG_CONFIG([$1][_CFLAGS], [cflags], [$2])
+_PKG_CONFIG([$1][_LIBS], [libs], [$2])
+
+m4_define([_PKG_TEXT], [Alternatively, you may set the environment variables $1[]_CFLAGS
+and $1[]_LIBS to avoid the need to call pkg-config.
+See the pkg-config man page for more details.])
+
+if test $pkg_failed = yes; then
+        _PKG_SHORT_ERRORS_SUPPORTED
+        if test $_pkg_short_errors_supported = yes; then
+	        $1[]_PKG_ERRORS=`$PKG_CONFIG --short-errors --errors-to-stdout --print-errors "$2"`
+        else 
+	        $1[]_PKG_ERRORS=`$PKG_CONFIG --errors-to-stdout --print-errors "$2"`
+        fi
+	# Put the nasty error message in config.log where it belongs
+	echo "$$1[]_PKG_ERRORS" >&AS_MESSAGE_LOG_FD
+
+	ifelse([$4], , [AC_MSG_ERROR(dnl
+[Package requirements ($2) were not met:
+
+$$1_PKG_ERRORS
+
+Consider adjusting the PKG_CONFIG_PATH environment variable if you
+installed software in a non-standard prefix.
+
+_PKG_TEXT
+])],
+		[AC_MSG_RESULT([no])
+                $4])
+elif test $pkg_failed = untried; then
+	ifelse([$4], , [AC_MSG_FAILURE(dnl
+[The pkg-config script could not be found or is too old.  Make sure it
+is in your PATH or set the PKG_CONFIG environment variable to the full
+path to pkg-config.
+
+_PKG_TEXT
+
+To get pkg-config, see <http://pkg-config.freedesktop.org/>.])],
+		[$4])
+else
+	$1[]_CFLAGS=$pkg_cv_[]$1[]_CFLAGS
+	$1[]_LIBS=$pkg_cv_[]$1[]_LIBS
+        AC_MSG_RESULT([yes])
+	ifelse([$3], , :, [$3])
+fi[]dnl
+])# PKG_CHECK_MODULES
+
 # Copyright (C) 2002, 2003, 2005, 2006, 2007  Free Software Foundation, Inc.
 #
 # This file is free software; the Free Software Foundation
Only in util-linux-ng-2.14.1-rc2: autom4te.cache
diff -ur util-linux-ng-2.14.1-rc2-orig/config.h.in util-linux-ng-2.14.1-rc2/config.h.in
--- util-linux-ng-2.14.1-rc2-orig/config.h.in	2008-08-22 13:09:34.000000000 +0200
+++ util-linux-ng-2.14.1-rc2/config.h.in	2008-09-03 10:34:24.000000000 +0200
@@ -83,9 +83,6 @@
 /* Define to 1 if you have the `audit' library (-laudit). */
 #undef HAVE_LIBAUDIT
 
-/* Define to 1 if you have the `blkid' library (-lblkid). */
-#undef HAVE_LIBBLKID
-
 /* Define to 1 if you have the `ncurses' library (-lncurses). */
 #undef HAVE_LIBNCURSES
 
@@ -104,9 +101,6 @@
 /* Define to 1 if you have the `uuid' library (-luuid). */
 #undef HAVE_LIBUUID
 
-/* Define to 1 if you have the `volume_id' library (-lvolume_id). */
-#undef HAVE_LIBVOLUME_ID
-
 /* Define to 1 if you have the `z' library (-lz). */
 #undef HAVE_LIBZ
 
Only in util-linux-ng-2.14.1-rc2: config.h.in~
diff -ur util-linux-ng-2.14.1-rc2-orig/configure util-linux-ng-2.14.1-rc2/configure
--- util-linux-ng-2.14.1-rc2-orig/configure	2008-08-22 13:08:17.000000000 +0200
+++ util-linux-ng-2.14.1-rc2/configure	2008-09-03 10:34:23.000000000 +0200
@@ -732,10 +732,10 @@
 HAVE_BLKID_FALSE
 HAVE_VOLUME_ID_TRUE
 HAVE_VOLUME_ID_FALSE
-BLKID_LIBS
-BLKID_LIBS_STATIC
-VOLUMEID_LIBS
-VOLUMEID_LIBS_STATIC
+REQUIRES_FSPROBE
+PKG_CONFIG
+fsprobe_CFLAGS
+fsprobe_LIBS
 MKINSTALLDIRS
 USE_NLS
 MSGFMT
@@ -843,10 +843,9 @@
 LIBS
 CPPFLAGS
 CPP
-BLKID_LIBS
-BLKID_LIBS_STATIC
-VOLUMEID_LIBS
-VOLUMEID_LIBS_STATIC
+PKG_CONFIG
+fsprobe_CFLAGS
+fsprobe_LIBS
 SUID_CFLAGS
 SUID_LDFLAGS'
 
@@ -1494,13 +1493,11 @@
   CPPFLAGS    C/C++/Objective C preprocessor flags, e.g. -I<include dir> if
               you have headers in a nonstandard directory <include dir>
   CPP         C preprocessor
-  BLKID_LIBS  -l options for linking dynamically with blkid
-  BLKID_LIBS_STATIC
-              -l options for linking statically with blkid
-  VOLUMEID_LIBS
-              -l options for linking dynamically with volume_id
-  VOLUMEID_LIBS_STATIC
-              -l options for linking statically with volume_id
+  PKG_CONFIG  path to pkg-config utility
+  fsprobe_CFLAGS
+              C compiler flags for fsprobe, overriding pkg-config
+  fsprobe_LIBS
+              linker flags for fsprobe, overriding pkg-config
   SUID_CFLAGS CFLAGS used for binaries which are usually with the suid bit
   SUID_LDFLAGS
               LDFLAGS used for binaries which are usually with the suid bit
@@ -5608,11 +5605,13 @@
 cat confdefs.h >>conftest.$ac_ext
 cat >>conftest.$ac_ext <<_ACEOF
 /* end confdefs.h.  */
-#include <stdio.h>
+#include <sys/types.h> /* for off_t */
+     #include <stdio.h>
 int
 main ()
 {
-return fseeko (stdin, 0, 0) && (fseeko) (stdin, 0, 0);
+int (*fp) (FILE *, off_t, int) = fseeko;
+     return fseeko (stdin, 0, 0) && fp (stdin, 0, 0);
   ;
   return 0;
 }
@@ -5652,11 +5651,13 @@
 cat >>conftest.$ac_ext <<_ACEOF
 /* end confdefs.h.  */
 #define _LARGEFILE_SOURCE 1
-#include <stdio.h>
+#include <sys/types.h> /* for off_t */
+     #include <stdio.h>
 int
 main ()
 {
-return fseeko (stdin, 0, 0) && (fseeko) (stdin, 0, 0);
+int (*fp) (FILE *, off_t, int) = fseeko;
+     return fseeko (stdin, 0, 0) && fp (stdin, 0, 0);
   ;
   return 0;
 }
@@ -6050,6 +6051,43 @@
 echo "$as_me: WARNING: uuid library is not found; mkswap(8) will not generate UUIDs" >&2;}
 fi
 
+# AC_MSG_CHECKING([whether to enable uuid support for mkswap(8)])
+# AC_ARG_ENABLE(uuid,
+#     AS_HELP_STRING([--enable-uuid], [enable uuid support for mkswap(8) [default=auto]]),
+# 	[case "$enableval" in
+# 	y | yes) CONFIG_UUID=yes;;
+# 	n | no)  CONFIG_UUID=no;;
+#         auto)    CONFIG_UUID=auto;;
+# 	*)
+# 		AC_MSG_ERROR([--enable-uuid="$enableval" is not valid])
+# 		;;
+#         esac],
+#     [CONFIG_UUID=auto]
+# )
+# AC_MSG_RESULT([$CONFIG_UUID])
+#
+# if test $CONFIG_UUID = no; then
+# 	HAVE_UUID=false
+# 	UUID_LIBS=
+# else
+# 	UTIL_CHECK_LIB(uuid, uuid_is_null)
+# 	if test $CONFIG_UUID = yes && test x$have_uuid = xno; then
+# 		AC_MSG_ERROR([uuid library is not found but --enable-uuid given; please install libuuid])
+# 	fi
+# 	if test $CONFIG_UUID = auto && test x$have_uuid = xno; then
+#   		AC_MSG_WARN([uuid library is not found; mkswap(8) will not generate UUIDs])
+# 		HAVE_UUID=no
+# 		UUID_LIBS=
+# 	fi
+# 	if test x$have_uuid = xyes; then
+# 		HAVE_UUID=true
+# 		UUID_LIBS=-luuid
+# 	fi
+# fi
+# AM_CONDITIONAL(HAVE_UUID, $HAVE_UUID)
+# AC_SUBST(UUID_LIBS)
+
+
 
 
   have_util=yes
@@ -6222,6 +6260,7 @@
 
 
 
+
 # Check whether --with-fsprobe was given.
 if test "${with_fsprobe+set}" = set; then
   withval=$with_fsprobe;
@@ -6231,7 +6270,7 @@
 fi
 
 
- if false; then
+ if test x$with_fsprobe = xblkid; then
   HAVE_BLKID_TRUE=
   HAVE_BLKID_FALSE='#'
 else
@@ -6239,7 +6278,7 @@
   HAVE_BLKID_FALSE=
 fi
 
- if false; then
+ if test x$with_fsprobe = xvolume_id; then
   HAVE_VOLUME_ID_TRUE=
   HAVE_VOLUME_ID_FALSE='#'
 else
@@ -6251,227 +6290,220 @@
 have_blkid=no
 have_volume_id=no
 if test "x$with_fsprobe" = xblkid; then
+  REQUIRES_FSPROBE="blkid"
+elif test "x$with_fsprobe" = xvolume_id; then
+  REQUIRES_FSPROBE="volume_id"
+fi
 
+#if test -n "$enable_static_programs"; then
+# FIXME - do something to tell pkg-config to probe with --static
+#fi
 
-  have_blkid=yes
 
-{ echo "$as_me:$LINENO: checking for blkid_known_fstype in -lblkid" >&5
-echo $ECHO_N "checking for blkid_known_fstype in -lblkid... $ECHO_C" >&6; }
-if test "${ac_cv_lib_blkid_blkid_known_fstype+set}" = set; then
+
+if test "x$ac_cv_env_PKG_CONFIG_set" != "xset"; then
+	if test -n "$ac_tool_prefix"; then
+  # Extract the first word of "${ac_tool_prefix}pkg-config", so it can be a program name with args.
+set dummy ${ac_tool_prefix}pkg-config; ac_word=$2
+{ echo "$as_me:$LINENO: checking for $ac_word" >&5
+echo $ECHO_N "checking for $ac_word... $ECHO_C" >&6; }
+if test "${ac_cv_path_PKG_CONFIG+set}" = set; then
   echo $ECHO_N "(cached) $ECHO_C" >&6
 else
-  ac_check_lib_save_LIBS=$LIBS
-LIBS="-lblkid  $LIBS"
-cat >conftest.$ac_ext <<_ACEOF
-/* confdefs.h.  */
-_ACEOF
-cat confdefs.h >>conftest.$ac_ext
-cat >>conftest.$ac_ext <<_ACEOF
-/* end confdefs.h.  */
+  case $PKG_CONFIG in
+  [\\/]* | ?:[\\/]*)
+  ac_cv_path_PKG_CONFIG="$PKG_CONFIG" # Let the user override the test with a path.
+  ;;
+  *)
+  as_save_IFS=$IFS; IFS=$PATH_SEPARATOR
+for as_dir in $PATH
+do
+  IFS=$as_save_IFS
+  test -z "$as_dir" && as_dir=.
+  for ac_exec_ext in '' $ac_executable_extensions; do
+  if { test -f "$as_dir/$ac_word$ac_exec_ext" && $as_test_x "$as_dir/$ac_word$ac_exec_ext"; }; then
+    ac_cv_path_PKG_CONFIG="$as_dir/$ac_word$ac_exec_ext"
+    echo "$as_me:$LINENO: found $as_dir/$ac_word$ac_exec_ext" >&5
+    break 2
+  fi
+done
+done
+IFS=$as_save_IFS
 
-/* Override any GCC internal prototype to avoid an error.
-   Use char because int might match the return type of a GCC
-   builtin and then its argument prototype would still apply.  */
-#ifdef __cplusplus
-extern "C"
-#endif
-char blkid_known_fstype ();
-int
-main ()
-{
-return blkid_known_fstype ();
-  ;
-  return 0;
-}
-_ACEOF
-rm -f conftest.$ac_objext conftest$ac_exeext
-if { (ac_try="$ac_link"
-case "(($ac_try" in
-  *\"* | *\`* | *\\*) ac_try_echo=\$ac_try;;
-  *) ac_try_echo=$ac_try;;
+  ;;
 esac
-eval "echo \"\$as_me:$LINENO: $ac_try_echo\"") >&5
-  (eval "$ac_link") 2>conftest.er1
-  ac_status=$?
-  grep -v '^ *+' conftest.er1 >conftest.err
-  rm -f conftest.er1
-  cat conftest.err >&5
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); } && {
-	 test -z "$ac_c_werror_flag" ||
-	 test ! -s conftest.err
-       } && test -s conftest$ac_exeext &&
-       $as_test_x conftest$ac_exeext; then
-  ac_cv_lib_blkid_blkid_known_fstype=yes
+fi
+PKG_CONFIG=$ac_cv_path_PKG_CONFIG
+if test -n "$PKG_CONFIG"; then
+  { echo "$as_me:$LINENO: result: $PKG_CONFIG" >&5
+echo "${ECHO_T}$PKG_CONFIG" >&6; }
 else
-  echo "$as_me: failed program was:" >&5
-sed 's/^/| /' conftest.$ac_ext >&5
-
-	ac_cv_lib_blkid_blkid_known_fstype=no
+  { echo "$as_me:$LINENO: result: no" >&5
+echo "${ECHO_T}no" >&6; }
 fi
 
-rm -f core conftest.err conftest.$ac_objext conftest_ipa8_conftest.oo \
-      conftest$ac_exeext conftest.$ac_ext
-LIBS=$ac_check_lib_save_LIBS
-fi
-{ echo "$as_me:$LINENO: result: $ac_cv_lib_blkid_blkid_known_fstype" >&5
-echo "${ECHO_T}$ac_cv_lib_blkid_blkid_known_fstype" >&6; }
-if test $ac_cv_lib_blkid_blkid_known_fstype = yes; then
-  cat >>confdefs.h <<_ACEOF
-#define HAVE_LIBBLKID 1
-_ACEOF
 
-  LIBS="-lblkid $LIBS"
+fi
+if test -z "$ac_cv_path_PKG_CONFIG"; then
+  ac_pt_PKG_CONFIG=$PKG_CONFIG
+  # Extract the first word of "pkg-config", so it can be a program name with args.
+set dummy pkg-config; ac_word=$2
+{ echo "$as_me:$LINENO: checking for $ac_word" >&5
+echo $ECHO_N "checking for $ac_word... $ECHO_C" >&6; }
+if test "${ac_cv_path_ac_pt_PKG_CONFIG+set}" = set; then
+  echo $ECHO_N "(cached) $ECHO_C" >&6
+else
+  case $ac_pt_PKG_CONFIG in
+  [\\/]* | ?:[\\/]*)
+  ac_cv_path_ac_pt_PKG_CONFIG="$ac_pt_PKG_CONFIG" # Let the user override the test with a path.
+  ;;
+  *)
+  as_save_IFS=$IFS; IFS=$PATH_SEPARATOR
+for as_dir in $PATH
+do
+  IFS=$as_save_IFS
+  test -z "$as_dir" && as_dir=.
+  for ac_exec_ext in '' $ac_executable_extensions; do
+  if { test -f "$as_dir/$ac_word$ac_exec_ext" && $as_test_x "$as_dir/$ac_word$ac_exec_ext"; }; then
+    ac_cv_path_ac_pt_PKG_CONFIG="$as_dir/$ac_word$ac_exec_ext"
+    echo "$as_me:$LINENO: found $as_dir/$ac_word$ac_exec_ext" >&5
+    break 2
+  fi
+done
+done
+IFS=$as_save_IFS
 
+  ;;
+esac
+fi
+ac_pt_PKG_CONFIG=$ac_cv_path_ac_pt_PKG_CONFIG
+if test -n "$ac_pt_PKG_CONFIG"; then
+  { echo "$as_me:$LINENO: result: $ac_pt_PKG_CONFIG" >&5
+echo "${ECHO_T}$ac_pt_PKG_CONFIG" >&6; }
 else
-  have_blkid=no
+  { echo "$as_me:$LINENO: result: no" >&5
+echo "${ECHO_T}no" >&6; }
 fi
 
-   if test $have_blkid = yes; then
-  HAVE_BLKID_TRUE=
-  HAVE_BLKID_FALSE='#'
+  if test "x$ac_pt_PKG_CONFIG" = x; then
+    PKG_CONFIG=""
+  else
+    case $cross_compiling:$ac_tool_warned in
+yes:)
+{ echo "$as_me:$LINENO: WARNING: In the future, Autoconf will not detect cross-tools
+whose name does not start with the host triplet.  If you think this
+configuration is useful to you, please write to autoconf@gnu.org." >&5
+echo "$as_me: WARNING: In the future, Autoconf will not detect cross-tools
+whose name does not start with the host triplet.  If you think this
+configuration is useful to you, please write to autoconf@gnu.org." >&2;}
+ac_tool_warned=yes ;;
+esac
+    PKG_CONFIG=$ac_pt_PKG_CONFIG
+  fi
 else
-  HAVE_BLKID_TRUE='#'
-  HAVE_BLKID_FALSE=
+  PKG_CONFIG="$ac_cv_path_PKG_CONFIG"
 fi
 
+fi
+if test -n "$PKG_CONFIG"; then
+	_pkg_min_version=0.9.0
+	{ echo "$as_me:$LINENO: checking pkg-config is at least version $_pkg_min_version" >&5
+echo $ECHO_N "checking pkg-config is at least version $_pkg_min_version... $ECHO_C" >&6; }
+	if $PKG_CONFIG --atleast-pkgconfig-version $_pkg_min_version; then
+		{ echo "$as_me:$LINENO: result: yes" >&5
+echo "${ECHO_T}yes" >&6; }
+	else
+		{ echo "$as_me:$LINENO: result: no" >&5
+echo "${ECHO_T}no" >&6; }
+		PKG_CONFIG=""
+	fi
 
-elif test "x$with_fsprobe" = xvolume_id; then
-
-
-  have_volume_id=yes
-
-{ echo "$as_me:$LINENO: checking for volume_id_encode_string in -lvolume_id" >&5
-echo $ECHO_N "checking for volume_id_encode_string in -lvolume_id... $ECHO_C" >&6; }
-if test "${ac_cv_lib_volume_id_volume_id_encode_string+set}" = set; then
-  echo $ECHO_N "(cached) $ECHO_C" >&6
-else
-  ac_check_lib_save_LIBS=$LIBS
-LIBS="-lvolume_id  $LIBS"
-cat >conftest.$ac_ext <<_ACEOF
-/* confdefs.h.  */
-_ACEOF
-cat confdefs.h >>conftest.$ac_ext
-cat >>conftest.$ac_ext <<_ACEOF
-/* end confdefs.h.  */
+fi
 
-/* Override any GCC internal prototype to avoid an error.
-   Use char because int might match the return type of a GCC
-   builtin and then its argument prototype would still apply.  */
-#ifdef __cplusplus
-extern "C"
-#endif
-char volume_id_encode_string ();
-int
-main ()
-{
-return volume_id_encode_string ();
-  ;
-  return 0;
-}
-_ACEOF
-rm -f conftest.$ac_objext conftest$ac_exeext
-if { (ac_try="$ac_link"
-case "(($ac_try" in
-  *\"* | *\`* | *\\*) ac_try_echo=\$ac_try;;
-  *) ac_try_echo=$ac_try;;
-esac
-eval "echo \"\$as_me:$LINENO: $ac_try_echo\"") >&5
-  (eval "$ac_link") 2>conftest.er1
+pkg_failed=no
+{ echo "$as_me:$LINENO: checking for fsprobe" >&5
+echo $ECHO_N "checking for fsprobe... $ECHO_C" >&6; }
+
+if test -n "$PKG_CONFIG"; then
+    if test -n "$fsprobe_CFLAGS"; then
+        pkg_cv_fsprobe_CFLAGS="$fsprobe_CFLAGS"
+    else
+        if test -n "$PKG_CONFIG" && \
+    { (echo "$as_me:$LINENO: \$PKG_CONFIG --exists --print-errors \"\${REQUIRES_FSPROBE}\"") >&5
+  ($PKG_CONFIG --exists --print-errors "${REQUIRES_FSPROBE}") 2>&5
   ac_status=$?
-  grep -v '^ *+' conftest.er1 >conftest.err
-  rm -f conftest.er1
-  cat conftest.err >&5
   echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); } && {
-	 test -z "$ac_c_werror_flag" ||
-	 test ! -s conftest.err
-       } && test -s conftest$ac_exeext &&
-       $as_test_x conftest$ac_exeext; then
-  ac_cv_lib_volume_id_volume_id_encode_string=yes
+  (exit $ac_status); }; then
+  pkg_cv_fsprobe_CFLAGS=`$PKG_CONFIG --cflags "${REQUIRES_FSPROBE}" 2>/dev/null`
 else
-  echo "$as_me: failed program was:" >&5
-sed 's/^/| /' conftest.$ac_ext >&5
-
-	ac_cv_lib_volume_id_volume_id_encode_string=no
-fi
-
-rm -f core conftest.err conftest.$ac_objext conftest_ipa8_conftest.oo \
-      conftest$ac_exeext conftest.$ac_ext
-LIBS=$ac_check_lib_save_LIBS
+  pkg_failed=yes
 fi
-{ echo "$as_me:$LINENO: result: $ac_cv_lib_volume_id_volume_id_encode_string" >&5
-echo "${ECHO_T}$ac_cv_lib_volume_id_volume_id_encode_string" >&6; }
-if test $ac_cv_lib_volume_id_volume_id_encode_string = yes; then
-  cat >>confdefs.h <<_ACEOF
-#define HAVE_LIBVOLUME_ID 1
-_ACEOF
-
-  LIBS="-lvolume_id $LIBS"
-
+    fi
 else
-  have_volume_id=no
+	pkg_failed=untried
 fi
-
-   if test $have_volume_id = yes; then
-  HAVE_VOLUME_ID_TRUE=
-  HAVE_VOLUME_ID_FALSE='#'
+if test -n "$PKG_CONFIG"; then
+    if test -n "$fsprobe_LIBS"; then
+        pkg_cv_fsprobe_LIBS="$fsprobe_LIBS"
+    else
+        if test -n "$PKG_CONFIG" && \
+    { (echo "$as_me:$LINENO: \$PKG_CONFIG --exists --print-errors \"\${REQUIRES_FSPROBE}\"") >&5
+  ($PKG_CONFIG --exists --print-errors "${REQUIRES_FSPROBE}") 2>&5
+  ac_status=$?
+  echo "$as_me:$LINENO: \$? = $ac_status" >&5
+  (exit $ac_status); }; then
+  pkg_cv_fsprobe_LIBS=`$PKG_CONFIG --libs "${REQUIRES_FSPROBE}" 2>/dev/null`
 else
-  HAVE_VOLUME_ID_TRUE='#'
-  HAVE_VOLUME_ID_FALSE=
+  pkg_failed=yes
 fi
-
-
+    fi
+else
+	pkg_failed=untried
 fi
 
-if test "x$have_blkid" = xno && test "x$have_volume_id" = xno; then
-  { { echo "$as_me:$LINENO: error: blkid or volume_id is needed to build util-linux-ng." >&5
-echo "$as_me: error: blkid or volume_id is needed to build util-linux-ng." >&2;}
-   { (exit 1); exit 1; }; }
-fi
 
 
+if test $pkg_failed = yes; then
 
-# These default values should work in most cases:
-: ${BLKID_LIBS='-lblkid'}
-: ${VOLUMEID_LIBS='-lvolume_id'}
+if $PKG_CONFIG --atleast-pkgconfig-version 0.20; then
+        _pkg_short_errors_supported=yes
+else
+        _pkg_short_errors_supported=no
+fi
+        if test $_pkg_short_errors_supported = yes; then
+	        fsprobe_PKG_ERRORS=`$PKG_CONFIG --short-errors --errors-to-stdout --print-errors "${REQUIRES_FSPROBE}"`
+        else
+	        fsprobe_PKG_ERRORS=`$PKG_CONFIG --errors-to-stdout --print-errors "${REQUIRES_FSPROBE}"`
+        fi
+	# Put the nasty error message in config.log where it belongs
+	echo "$fsprobe_PKG_ERRORS" >&5
 
-# ... but for static build, we need to consult pkg-config:
-if test -n "$enable_static_programs"; then
-  case $with_fsprobe in
-  blkid)
-  if { (echo "$as_me:$LINENO: pkg-config --exists --print-errors \"blkid\"") >&5
-  (pkg-config --exists --print-errors "blkid") 2>&5
-  ac_status=$?
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); }; then
-    BLKID_LIBS_STATIC=`pkg-config --libs --static "blkid"`
-  else
-    { { echo "$as_me:$LINENO: error: pkg-config description of blkid, needed for static build, is not available" >&5
-echo "$as_me: error: pkg-config description of blkid, needed for static build, is not available" >&2;}
-   { (exit 1); exit 1; }; }
-  fi
- ;;
-  volume_id)
-  if { (echo "$as_me:$LINENO: pkg-config --exists --print-errors \"libvolume_id\"") >&5
-  (pkg-config --exists --print-errors "libvolume_id") 2>&5
-  ac_status=$?
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); }; then
-    VOLUMEID_LIBS_STATIC=`pkg-config --libs --static "libvolume_id"`
-  else
-    { { echo "$as_me:$LINENO: error: pkg-config description of libvolume_id, needed for static build, is not available" >&5
-echo "$as_me: error: pkg-config description of libvolume_id, needed for static build, is not available" >&2;}
+	{ echo "$as_me:$LINENO: result: no" >&5
+echo "${ECHO_T}no" >&6; }
+                { { echo "$as_me:$LINENO: error: *** ${REQUIRES_FSPROBE} not found by pkg-config on your system" >&5
+echo "$as_me: error: *** ${REQUIRES_FSPROBE} not found by pkg-config on your system" >&2;}
    { (exit 1); exit 1; }; }
-  fi
- ;;
-  esac
-fi
 
+elif test $pkg_failed = untried; then
+	{ { echo "$as_me:$LINENO: error: *** ${REQUIRES_FSPROBE} not found by pkg-config on your system" >&5
+echo "$as_me: error: *** ${REQUIRES_FSPROBE} not found by pkg-config on your system" >&2;}
+   { (exit 1); exit 1; }; }
 
+else
+	fsprobe_CFLAGS=$pkg_cv_fsprobe_CFLAGS
+	fsprobe_LIBS=$pkg_cv_fsprobe_LIBS
+        { echo "$as_me:$LINENO: result: yes" >&5
+echo "${ECHO_T}yes" >&6; }
+	:
+fi
 
 
 
+# FIXME rsc: is this still necessary with the pkg-config check?
+#AC_ARG_VAR([BLKID_LIBS], [-l options for linking dynamically with blkid])
+#AC_ARG_VAR([BLKID_LIBS_STATIC], [-l options for linking statically with blkid])
+#AC_ARG_VAR([VOLUMEID_LIBS], [-l options for linking dynamically with volume_id])
+#AC_ARG_VAR([VOLUMEID_LIBS_STATIC], [-l options for linking statically with volume_id])
 
 
 
@@ -11709,20 +11741,6 @@
 Usually this means the macro was only invoked conditionally." >&2;}
    { (exit 1); exit 1; }; }
 fi
-if test -z "${HAVE_BLKID_TRUE}" && test -z "${HAVE_BLKID_FALSE}"; then
-  { { echo "$as_me:$LINENO: error: conditional \"HAVE_BLKID\" was never defined.
-Usually this means the macro was only invoked conditionally." >&5
-echo "$as_me: error: conditional \"HAVE_BLKID\" was never defined.
-Usually this means the macro was only invoked conditionally." >&2;}
-   { (exit 1); exit 1; }; }
-fi
-if test -z "${HAVE_VOLUME_ID_TRUE}" && test -z "${HAVE_VOLUME_ID_FALSE}"; then
-  { { echo "$as_me:$LINENO: error: conditional \"HAVE_VOLUME_ID\" was never defined.
-Usually this means the macro was only invoked conditionally." >&5
-echo "$as_me: error: conditional \"HAVE_VOLUME_ID\" was never defined.
-Usually this means the macro was only invoked conditionally." >&2;}
-   { (exit 1); exit 1; }; }
-fi
 if test -z "${HAVE_NCURSES_TRUE}" && test -z "${HAVE_NCURSES_FALSE}"; then
   { { echo "$as_me:$LINENO: error: conditional \"HAVE_NCURSES\" was never defined.
 Usually this means the macro was only invoked conditionally." >&5
@@ -12746,10 +12764,10 @@
 HAVE_BLKID_FALSE!$HAVE_BLKID_FALSE$ac_delim
 HAVE_VOLUME_ID_TRUE!$HAVE_VOLUME_ID_TRUE$ac_delim
 HAVE_VOLUME_ID_FALSE!$HAVE_VOLUME_ID_FALSE$ac_delim
-BLKID_LIBS!$BLKID_LIBS$ac_delim
-BLKID_LIBS_STATIC!$BLKID_LIBS_STATIC$ac_delim
-VOLUMEID_LIBS!$VOLUMEID_LIBS$ac_delim
-VOLUMEID_LIBS_STATIC!$VOLUMEID_LIBS_STATIC$ac_delim
+REQUIRES_FSPROBE!$REQUIRES_FSPROBE$ac_delim
+PKG_CONFIG!$PKG_CONFIG$ac_delim
+fsprobe_CFLAGS!$fsprobe_CFLAGS$ac_delim
+fsprobe_LIBS!$fsprobe_LIBS$ac_delim
 MKINSTALLDIRS!$MKINSTALLDIRS$ac_delim
 USE_NLS!$USE_NLS$ac_delim
 MSGFMT!$MSGFMT$ac_delim
diff -ur util-linux-ng-2.14.1-rc2-orig/disk-utils/Makefile.in util-linux-ng-2.14.1-rc2/disk-utils/Makefile.in
--- util-linux-ng-2.14.1-rc2-orig/disk-utils/Makefile.in	2008-08-22 13:08:18.000000000 +0200
+++ util-linux-ng-2.14.1-rc2/disk-utils/Makefile.in	2008-09-03 10:34:25.000000000 +0200
@@ -150,8 +150,6 @@
 AUTOMAKE = @AUTOMAKE@
 AWK = @AWK@
 BLKID = @BLKID@
-BLKID_LIBS = @BLKID_LIBS@
-BLKID_LIBS_STATIC = @BLKID_LIBS_STATIC@
 CC = @CC@
 CCDEPMODE = @CCDEPMODE@
 CFLAGS = @CFLAGS@
@@ -197,7 +195,9 @@
 PACKAGE_VERSION = @PACKAGE_VERSION@
 PATH_SEPARATOR = @PATH_SEPARATOR@
 PERL = @PERL@
+PKG_CONFIG = @PKG_CONFIG@
 POSUB = @POSUB@
+REQUIRES_FSPROBE = @REQUIRES_FSPROBE@
 SELINUX_LIBS = @SELINUX_LIBS@
 SELINUX_LIBS_STATIC = @SELINUX_LIBS_STATIC@
 SET_MAKE = @SET_MAKE@
@@ -208,8 +208,6 @@
 USE_NLS = @USE_NLS@
 VERSION = @VERSION@
 VOLID = @VOLID@
-VOLUMEID_LIBS = @VOLUMEID_LIBS@
-VOLUMEID_LIBS_STATIC = @VOLUMEID_LIBS_STATIC@
 XGETTEXT = @XGETTEXT@
 abs_builddir = @abs_builddir@
 abs_srcdir = @abs_srcdir@
@@ -233,6 +231,8 @@
 docdir = @docdir@
 dvidir = @dvidir@
 exec_prefix = @exec_prefix@
+fsprobe_CFLAGS = @fsprobe_CFLAGS@
+fsprobe_LIBS = @fsprobe_LIBS@
 host = @host@
 host_alias = @host_alias@
 host_cpu = @host_cpu@
diff -ur util-linux-ng-2.14.1-rc2-orig/fdisk/Makefile.in util-linux-ng-2.14.1-rc2/fdisk/Makefile.in
--- util-linux-ng-2.14.1-rc2-orig/fdisk/Makefile.in	2008-08-22 13:08:18.000000000 +0200
+++ util-linux-ng-2.14.1-rc2/fdisk/Makefile.in	2008-09-03 10:34:25.000000000 +0200
@@ -155,8 +155,6 @@
 AUTOMAKE = @AUTOMAKE@
 AWK = @AWK@
 BLKID = @BLKID@
-BLKID_LIBS = @BLKID_LIBS@
-BLKID_LIBS_STATIC = @BLKID_LIBS_STATIC@
 CC = @CC@
 CCDEPMODE = @CCDEPMODE@
 CFLAGS = @CFLAGS@
@@ -202,7 +200,9 @@
 PACKAGE_VERSION = @PACKAGE_VERSION@
 PATH_SEPARATOR = @PATH_SEPARATOR@
 PERL = @PERL@
+PKG_CONFIG = @PKG_CONFIG@
 POSUB = @POSUB@
+REQUIRES_FSPROBE = @REQUIRES_FSPROBE@
 SELINUX_LIBS = @SELINUX_LIBS@
 SELINUX_LIBS_STATIC = @SELINUX_LIBS_STATIC@
 SET_MAKE = @SET_MAKE@
@@ -213,8 +213,6 @@
 USE_NLS = @USE_NLS@
 VERSION = @VERSION@
 VOLID = @VOLID@
-VOLUMEID_LIBS = @VOLUMEID_LIBS@
-VOLUMEID_LIBS_STATIC = @VOLUMEID_LIBS_STATIC@
 XGETTEXT = @XGETTEXT@
 abs_builddir = @abs_builddir@
 abs_srcdir = @abs_srcdir@
@@ -238,6 +236,8 @@
 docdir = @docdir@
 dvidir = @dvidir@
 exec_prefix = @exec_prefix@
+fsprobe_CFLAGS = @fsprobe_CFLAGS@
+fsprobe_LIBS = @fsprobe_LIBS@
 host = @host@
 host_alias = @host_alias@
 host_cpu = @host_cpu@
diff -ur util-linux-ng-2.14.1-rc2-orig/getopt/Makefile.in util-linux-ng-2.14.1-rc2/getopt/Makefile.in
--- util-linux-ng-2.14.1-rc2-orig/getopt/Makefile.in	2008-08-22 13:08:18.000000000 +0200
+++ util-linux-ng-2.14.1-rc2/getopt/Makefile.in	2008-09-03 10:34:25.000000000 +0200
@@ -83,8 +83,6 @@
 AUTOMAKE = @AUTOMAKE@
 AWK = @AWK@
 BLKID = @BLKID@
-BLKID_LIBS = @BLKID_LIBS@
-BLKID_LIBS_STATIC = @BLKID_LIBS_STATIC@
 CC = @CC@
 CCDEPMODE = @CCDEPMODE@
 CFLAGS = @CFLAGS@
@@ -130,7 +128,9 @@
 PACKAGE_VERSION = @PACKAGE_VERSION@
 PATH_SEPARATOR = @PATH_SEPARATOR@
 PERL = @PERL@
+PKG_CONFIG = @PKG_CONFIG@
 POSUB = @POSUB@
+REQUIRES_FSPROBE = @REQUIRES_FSPROBE@
 SELINUX_LIBS = @SELINUX_LIBS@
 SELINUX_LIBS_STATIC = @SELINUX_LIBS_STATIC@
 SET_MAKE = @SET_MAKE@
@@ -141,8 +141,6 @@
 USE_NLS = @USE_NLS@
 VERSION = @VERSION@
 VOLID = @VOLID@
-VOLUMEID_LIBS = @VOLUMEID_LIBS@
-VOLUMEID_LIBS_STATIC = @VOLUMEID_LIBS_STATIC@
 XGETTEXT = @XGETTEXT@
 abs_builddir = @abs_builddir@
 abs_srcdir = @abs_srcdir@
@@ -166,6 +164,8 @@
 docdir = @docdir@
 dvidir = @dvidir@
 exec_prefix = @exec_prefix@
+fsprobe_CFLAGS = @fsprobe_CFLAGS@
+fsprobe_LIBS = @fsprobe_LIBS@
 host = @host@
 host_alias = @host_alias@
 host_cpu = @host_cpu@
diff -ur util-linux-ng-2.14.1-rc2-orig/hwclock/Makefile.in util-linux-ng-2.14.1-rc2/hwclock/Makefile.in
--- util-linux-ng-2.14.1-rc2-orig/hwclock/Makefile.in	2008-08-22 13:08:18.000000000 +0200
+++ util-linux-ng-2.14.1-rc2/hwclock/Makefile.in	2008-09-03 10:34:25.000000000 +0200
@@ -81,8 +81,6 @@
 AUTOMAKE = @AUTOMAKE@
 AWK = @AWK@
 BLKID = @BLKID@
-BLKID_LIBS = @BLKID_LIBS@
-BLKID_LIBS_STATIC = @BLKID_LIBS_STATIC@
 CC = @CC@
 CCDEPMODE = @CCDEPMODE@
 CFLAGS = @CFLAGS@
@@ -128,7 +126,9 @@
 PACKAGE_VERSION = @PACKAGE_VERSION@
 PATH_SEPARATOR = @PATH_SEPARATOR@
 PERL = @PERL@
+PKG_CONFIG = @PKG_CONFIG@
 POSUB = @POSUB@
+REQUIRES_FSPROBE = @REQUIRES_FSPROBE@
 SELINUX_LIBS = @SELINUX_LIBS@
 SELINUX_LIBS_STATIC = @SELINUX_LIBS_STATIC@
 SET_MAKE = @SET_MAKE@
@@ -139,8 +139,6 @@
 USE_NLS = @USE_NLS@
 VERSION = @VERSION@
 VOLID = @VOLID@
-VOLUMEID_LIBS = @VOLUMEID_LIBS@
-VOLUMEID_LIBS_STATIC = @VOLUMEID_LIBS_STATIC@
 XGETTEXT = @XGETTEXT@
 abs_builddir = @abs_builddir@
 abs_srcdir = @abs_srcdir@
@@ -164,6 +162,8 @@
 docdir = @docdir@
 dvidir = @dvidir@
 exec_prefix = @exec_prefix@
+fsprobe_CFLAGS = @fsprobe_CFLAGS@
+fsprobe_LIBS = @fsprobe_LIBS@
 host = @host@
 host_alias = @host_alias@
 host_cpu = @host_cpu@
diff -ur util-linux-ng-2.14.1-rc2-orig/include/Makefile.in util-linux-ng-2.14.1-rc2/include/Makefile.in
--- util-linux-ng-2.14.1-rc2-orig/include/Makefile.in	2008-08-22 13:08:18.000000000 +0200
+++ util-linux-ng-2.14.1-rc2/include/Makefile.in	2008-09-03 10:34:25.000000000 +0200
@@ -62,8 +62,6 @@
 AUTOMAKE = @AUTOMAKE@
 AWK = @AWK@
 BLKID = @BLKID@
-BLKID_LIBS = @BLKID_LIBS@
-BLKID_LIBS_STATIC = @BLKID_LIBS_STATIC@
 CC = @CC@
 CCDEPMODE = @CCDEPMODE@
 CFLAGS = @CFLAGS@
@@ -109,7 +107,9 @@
 PACKAGE_VERSION = @PACKAGE_VERSION@
 PATH_SEPARATOR = @PATH_SEPARATOR@
 PERL = @PERL@
+PKG_CONFIG = @PKG_CONFIG@
 POSUB = @POSUB@
+REQUIRES_FSPROBE = @REQUIRES_FSPROBE@
 SELINUX_LIBS = @SELINUX_LIBS@
 SELINUX_LIBS_STATIC = @SELINUX_LIBS_STATIC@
 SET_MAKE = @SET_MAKE@
@@ -120,8 +120,6 @@
 USE_NLS = @USE_NLS@
 VERSION = @VERSION@
 VOLID = @VOLID@
-VOLUMEID_LIBS = @VOLUMEID_LIBS@
-VOLUMEID_LIBS_STATIC = @VOLUMEID_LIBS_STATIC@
 XGETTEXT = @XGETTEXT@
 abs_builddir = @abs_builddir@
 abs_srcdir = @abs_srcdir@
@@ -145,6 +143,8 @@
 docdir = @docdir@
 dvidir = @dvidir@
 exec_prefix = @exec_prefix@
+fsprobe_CFLAGS = @fsprobe_CFLAGS@
+fsprobe_LIBS = @fsprobe_LIBS@
 host = @host@
 host_alias = @host_alias@
 host_cpu = @host_cpu@
diff -ur util-linux-ng-2.14.1-rc2-orig/lib/Makefile.in util-linux-ng-2.14.1-rc2/lib/Makefile.in
--- util-linux-ng-2.14.1-rc2-orig/lib/Makefile.in	2008-08-22 13:08:18.000000000 +0200
+++ util-linux-ng-2.14.1-rc2/lib/Makefile.in	2008-09-03 10:34:25.000000000 +0200
@@ -75,8 +75,6 @@
 AUTOMAKE = @AUTOMAKE@
 AWK = @AWK@
 BLKID = @BLKID@
-BLKID_LIBS = @BLKID_LIBS@
-BLKID_LIBS_STATIC = @BLKID_LIBS_STATIC@
 CC = @CC@
 CCDEPMODE = @CCDEPMODE@
 CFLAGS = @CFLAGS@
@@ -122,7 +120,9 @@
 PACKAGE_VERSION = @PACKAGE_VERSION@
 PATH_SEPARATOR = @PATH_SEPARATOR@
 PERL = @PERL@
+PKG_CONFIG = @PKG_CONFIG@
 POSUB = @POSUB@
+REQUIRES_FSPROBE = @REQUIRES_FSPROBE@
 SELINUX_LIBS = @SELINUX_LIBS@
 SELINUX_LIBS_STATIC = @SELINUX_LIBS_STATIC@
 SET_MAKE = @SET_MAKE@
@@ -133,8 +133,6 @@
 USE_NLS = @USE_NLS@
 VERSION = @VERSION@
 VOLID = @VOLID@
-VOLUMEID_LIBS = @VOLUMEID_LIBS@
-VOLUMEID_LIBS_STATIC = @VOLUMEID_LIBS_STATIC@
 XGETTEXT = @XGETTEXT@
 abs_builddir = @abs_builddir@
 abs_srcdir = @abs_srcdir@
@@ -158,6 +156,8 @@
 docdir = @docdir@
 dvidir = @dvidir@
 exec_prefix = @exec_prefix@
+fsprobe_CFLAGS = @fsprobe_CFLAGS@
+fsprobe_LIBS = @fsprobe_LIBS@
 host = @host@
 host_alias = @host_alias@
 host_cpu = @host_cpu@
diff -ur util-linux-ng-2.14.1-rc2-orig/login-utils/Makefile.in util-linux-ng-2.14.1-rc2/login-utils/Makefile.in
--- util-linux-ng-2.14.1-rc2-orig/login-utils/Makefile.in	2008-08-22 13:08:19.000000000 +0200
+++ util-linux-ng-2.14.1-rc2/login-utils/Makefile.in	2008-09-03 10:34:25.000000000 +0200
@@ -220,8 +220,6 @@
 AUTOMAKE = @AUTOMAKE@
 AWK = @AWK@
 BLKID = @BLKID@
-BLKID_LIBS = @BLKID_LIBS@
-BLKID_LIBS_STATIC = @BLKID_LIBS_STATIC@
 CC = @CC@
 CCDEPMODE = @CCDEPMODE@
 CFLAGS = @CFLAGS@
@@ -267,7 +265,9 @@
 PACKAGE_VERSION = @PACKAGE_VERSION@
 PATH_SEPARATOR = @PATH_SEPARATOR@
 PERL = @PERL@
+PKG_CONFIG = @PKG_CONFIG@
 POSUB = @POSUB@
+REQUIRES_FSPROBE = @REQUIRES_FSPROBE@
 SELINUX_LIBS = @SELINUX_LIBS@
 SELINUX_LIBS_STATIC = @SELINUX_LIBS_STATIC@
 SET_MAKE = @SET_MAKE@
@@ -278,8 +278,6 @@
 USE_NLS = @USE_NLS@
 VERSION = @VERSION@
 VOLID = @VOLID@
-VOLUMEID_LIBS = @VOLUMEID_LIBS@
-VOLUMEID_LIBS_STATIC = @VOLUMEID_LIBS_STATIC@
 XGETTEXT = @XGETTEXT@
 abs_builddir = @abs_builddir@
 abs_srcdir = @abs_srcdir@
@@ -303,6 +301,8 @@
 docdir = @docdir@
 dvidir = @dvidir@
 exec_prefix = @exec_prefix@
+fsprobe_CFLAGS = @fsprobe_CFLAGS@
+fsprobe_LIBS = @fsprobe_LIBS@
 host = @host@
 host_alias = @host_alias@
 host_cpu = @host_cpu@
diff -ur util-linux-ng-2.14.1-rc2-orig/Makefile.in util-linux-ng-2.14.1-rc2/Makefile.in
--- util-linux-ng-2.14.1-rc2-orig/Makefile.in	2008-08-22 13:08:20.000000000 +0200
+++ util-linux-ng-2.14.1-rc2/Makefile.in	2008-09-03 10:34:26.000000000 +0200
@@ -93,8 +93,6 @@
 AUTOMAKE = @AUTOMAKE@
 AWK = @AWK@
 BLKID = @BLKID@
-BLKID_LIBS = @BLKID_LIBS@
-BLKID_LIBS_STATIC = @BLKID_LIBS_STATIC@
 CC = @CC@
 CCDEPMODE = @CCDEPMODE@
 CFLAGS = @CFLAGS@
@@ -140,7 +138,9 @@
 PACKAGE_VERSION = @PACKAGE_VERSION@
 PATH_SEPARATOR = @PATH_SEPARATOR@
 PERL = @PERL@
+PKG_CONFIG = @PKG_CONFIG@
 POSUB = @POSUB@
+REQUIRES_FSPROBE = @REQUIRES_FSPROBE@
 SELINUX_LIBS = @SELINUX_LIBS@
 SELINUX_LIBS_STATIC = @SELINUX_LIBS_STATIC@
 SET_MAKE = @SET_MAKE@
@@ -151,8 +151,6 @@
 USE_NLS = @USE_NLS@
 VERSION = @VERSION@
 VOLID = @VOLID@
-VOLUMEID_LIBS = @VOLUMEID_LIBS@
-VOLUMEID_LIBS_STATIC = @VOLUMEID_LIBS_STATIC@
 XGETTEXT = @XGETTEXT@
 abs_builddir = @abs_builddir@
 abs_srcdir = @abs_srcdir@
@@ -176,6 +174,8 @@
 docdir = @docdir@
 dvidir = @dvidir@
 exec_prefix = @exec_prefix@
+fsprobe_CFLAGS = @fsprobe_CFLAGS@
+fsprobe_LIBS = @fsprobe_LIBS@
 host = @host@
 host_alias = @host_alias@
 host_cpu = @host_cpu@
diff -ur util-linux-ng-2.14.1-rc2-orig/misc-utils/Makefile.in util-linux-ng-2.14.1-rc2/misc-utils/Makefile.in
--- util-linux-ng-2.14.1-rc2-orig/misc-utils/Makefile.in	2008-08-22 13:08:19.000000000 +0200
+++ util-linux-ng-2.14.1-rc2/misc-utils/Makefile.in	2008-09-03 10:34:25.000000000 +0200
@@ -151,8 +151,6 @@
 AUTOMAKE = @AUTOMAKE@
 AWK = @AWK@
 BLKID = @BLKID@
-BLKID_LIBS = @BLKID_LIBS@
-BLKID_LIBS_STATIC = @BLKID_LIBS_STATIC@
 CC = @CC@
 CCDEPMODE = @CCDEPMODE@
 CFLAGS = @CFLAGS@
@@ -198,7 +196,9 @@
 PACKAGE_VERSION = @PACKAGE_VERSION@
 PATH_SEPARATOR = @PATH_SEPARATOR@
 PERL = @PERL@
+PKG_CONFIG = @PKG_CONFIG@
 POSUB = @POSUB@
+REQUIRES_FSPROBE = @REQUIRES_FSPROBE@
 SELINUX_LIBS = @SELINUX_LIBS@
 SELINUX_LIBS_STATIC = @SELINUX_LIBS_STATIC@
 SET_MAKE = @SET_MAKE@
@@ -209,8 +209,6 @@
 USE_NLS = @USE_NLS@
 VERSION = @VERSION@
 VOLID = @VOLID@
-VOLUMEID_LIBS = @VOLUMEID_LIBS@
-VOLUMEID_LIBS_STATIC = @VOLUMEID_LIBS_STATIC@
 XGETTEXT = @XGETTEXT@
 abs_builddir = @abs_builddir@
 abs_srcdir = @abs_srcdir@
@@ -234,6 +232,8 @@
 docdir = @docdir@
 dvidir = @dvidir@
 exec_prefix = @exec_prefix@
+fsprobe_CFLAGS = @fsprobe_CFLAGS@
+fsprobe_LIBS = @fsprobe_LIBS@
 host = @host@
 host_alias = @host_alias@
 host_cpu = @host_cpu@
diff -ur util-linux-ng-2.14.1-rc2-orig/mount/Makefile.in util-linux-ng-2.14.1-rc2/mount/Makefile.in
--- util-linux-ng-2.14.1-rc2-orig/mount/Makefile.in	2008-08-22 13:08:19.000000000 +0200
+++ util-linux-ng-2.14.1-rc2/mount/Makefile.in	2008-09-03 10:34:26.000000000 +0200
@@ -43,13 +43,13 @@
 @HAVE_STATIC_UMOUNT_TRUE@am__append_2 = umount.static
 @HAVE_STATIC_LOSETUP_TRUE@am__append_3 = losetup.static
 @HAVE_BLKID_TRUE@am__append_4 = fsprobe_blkid.c
-@HAVE_BLKID_TRUE@am__append_5 = $(BLKID_LIBS)
-@HAVE_BLKID_TRUE@am__append_6 = $(BLKID_LIBS_STATIC)
+@HAVE_BLKID_TRUE@am__append_5 = $(fsprobe_LIBS)
+@HAVE_BLKID_TRUE@am__append_6 = $(fsprobe_STATIC)
 @HAVE_SELINUX_TRUE@am__append_7 = $(SELINUX_LIBS)
 @HAVE_VOLUME_ID_TRUE@am__append_8 = fsprobe_volumeid.c
 @HAVE_VOLUME_ID_TRUE@am__append_9 = ../lib/linux_version.c ../lib/blkdev.c
-@HAVE_VOLUME_ID_TRUE@am__append_10 = $(VOLUMEID_LIBS)
-@HAVE_VOLUME_ID_TRUE@am__append_11 = $(VOLUMEID_LIBS_STATIC)
+@HAVE_VOLUME_ID_TRUE@am__append_10 = $(fsprobe_LIBS)
+@HAVE_VOLUME_ID_TRUE@am__append_11 = $(fsprobe_LIBS)
 @HAVE_PIVOT_ROOT_TRUE@am__append_12 = pivot_root
 @HAVE_PIVOT_ROOT_TRUE@am__append_13 = pivot_root.8
 noinst_PROGRAMS = mtab_lock_test$(EXEEXT)
@@ -149,7 +149,8 @@
 	setproctitle.$(OBJEXT)
 @HAVE_STATIC_MOUNT_TRUE@am_mount_static_OBJECTS = $(am__objects_15)
 mount_static_OBJECTS = $(am_mount_static_OBJECTS)
-@HAVE_SELINUX_FALSE@@HAVE_STATIC_MOUNT_TRUE@mount_static_DEPENDENCIES = $(am__DEPENDENCIES_4)
+am__DEPENDENCIES_6 = $(am__DEPENDENCIES_1) $(am__DEPENDENCIES_3)
+@HAVE_SELINUX_FALSE@@HAVE_STATIC_MOUNT_TRUE@mount_static_DEPENDENCIES = $(am__DEPENDENCIES_6)
 @HAVE_SELINUX_TRUE@mount_static_DEPENDENCIES = $(am__DEPENDENCIES_1)
 mount_static_LINK = $(CCLD) $(AM_CFLAGS) $(CFLAGS) \
 	$(mount_static_LDFLAGS) $(LDFLAGS) -o $@
@@ -205,7 +206,7 @@
 @HAVE_STATIC_UMOUNT_TRUE@am_umount_static_OBJECTS = $(am__objects_22)
 umount_static_OBJECTS = $(am_umount_static_OBJECTS)
 @HAVE_STATIC_UMOUNT_TRUE@umount_static_DEPENDENCIES =  \
-@HAVE_STATIC_UMOUNT_TRUE@	$(am__DEPENDENCIES_4)
+@HAVE_STATIC_UMOUNT_TRUE@	$(am__DEPENDENCIES_6)
 umount_static_LINK = $(CCLD) $(AM_CFLAGS) $(CFLAGS) \
 	$(umount_static_LDFLAGS) $(LDFLAGS) -o $@
 DEFAULT_INCLUDES = -I.@am__isrc@ -I$(top_builddir)
@@ -241,8 +242,6 @@
 AUTOMAKE = @AUTOMAKE@
 AWK = @AWK@
 BLKID = @BLKID@
-BLKID_LIBS = @BLKID_LIBS@
-BLKID_LIBS_STATIC = @BLKID_LIBS_STATIC@
 CC = @CC@
 CCDEPMODE = @CCDEPMODE@
 CFLAGS = @CFLAGS@
@@ -288,7 +287,9 @@
 PACKAGE_VERSION = @PACKAGE_VERSION@
 PATH_SEPARATOR = @PATH_SEPARATOR@
 PERL = @PERL@
+PKG_CONFIG = @PKG_CONFIG@
 POSUB = @POSUB@
+REQUIRES_FSPROBE = @REQUIRES_FSPROBE@
 SELINUX_LIBS = @SELINUX_LIBS@
 SELINUX_LIBS_STATIC = @SELINUX_LIBS_STATIC@
 SET_MAKE = @SET_MAKE@
@@ -299,8 +300,6 @@
 USE_NLS = @USE_NLS@
 VERSION = @VERSION@
 VOLID = @VOLID@
-VOLUMEID_LIBS = @VOLUMEID_LIBS@
-VOLUMEID_LIBS_STATIC = @VOLUMEID_LIBS_STATIC@
 XGETTEXT = @XGETTEXT@
 abs_builddir = @abs_builddir@
 abs_srcdir = @abs_srcdir@
@@ -324,6 +323,8 @@
 docdir = @docdir@
 dvidir = @dvidir@
 exec_prefix = @exec_prefix@
+fsprobe_CFLAGS = @fsprobe_CFLAGS@
+fsprobe_LIBS = @fsprobe_LIBS@
 host = @host@
 host_alias = @host_alias@
 host_cpu = @host_cpu@
diff -ur util-linux-ng-2.14.1-rc2-orig/partx/Makefile.in util-linux-ng-2.14.1-rc2/partx/Makefile.in
--- util-linux-ng-2.14.1-rc2-orig/partx/Makefile.in	2008-08-22 13:08:19.000000000 +0200
+++ util-linux-ng-2.14.1-rc2/partx/Makefile.in	2008-09-03 10:34:26.000000000 +0200
@@ -91,8 +91,6 @@
 AUTOMAKE = @AUTOMAKE@
 AWK = @AWK@
 BLKID = @BLKID@
-BLKID_LIBS = @BLKID_LIBS@
-BLKID_LIBS_STATIC = @BLKID_LIBS_STATIC@
 CC = @CC@
 CCDEPMODE = @CCDEPMODE@
 CFLAGS = @CFLAGS@
@@ -138,7 +136,9 @@
 PACKAGE_VERSION = @PACKAGE_VERSION@
 PATH_SEPARATOR = @PATH_SEPARATOR@
 PERL = @PERL@
+PKG_CONFIG = @PKG_CONFIG@
 POSUB = @POSUB@
+REQUIRES_FSPROBE = @REQUIRES_FSPROBE@
 SELINUX_LIBS = @SELINUX_LIBS@
 SELINUX_LIBS_STATIC = @SELINUX_LIBS_STATIC@
 SET_MAKE = @SET_MAKE@
@@ -149,8 +149,6 @@
 USE_NLS = @USE_NLS@
 VERSION = @VERSION@
 VOLID = @VOLID@
-VOLUMEID_LIBS = @VOLUMEID_LIBS@
-VOLUMEID_LIBS_STATIC = @VOLUMEID_LIBS_STATIC@
 XGETTEXT = @XGETTEXT@
 abs_builddir = @abs_builddir@
 abs_srcdir = @abs_srcdir@
@@ -174,6 +172,8 @@
 docdir = @docdir@
 dvidir = @dvidir@
 exec_prefix = @exec_prefix@
+fsprobe_CFLAGS = @fsprobe_CFLAGS@
+fsprobe_LIBS = @fsprobe_LIBS@
 host = @host@
 host_alias = @host_alias@
 host_cpu = @host_cpu@
diff -ur util-linux-ng-2.14.1-rc2-orig/schedutils/Makefile.in util-linux-ng-2.14.1-rc2/schedutils/Makefile.in
--- util-linux-ng-2.14.1-rc2-orig/schedutils/Makefile.in	2008-08-22 13:08:19.000000000 +0200
+++ util-linux-ng-2.14.1-rc2/schedutils/Makefile.in	2008-09-03 10:34:26.000000000 +0200
@@ -92,8 +92,6 @@
 AUTOMAKE = @AUTOMAKE@
 AWK = @AWK@
 BLKID = @BLKID@
-BLKID_LIBS = @BLKID_LIBS@
-BLKID_LIBS_STATIC = @BLKID_LIBS_STATIC@
 CC = @CC@
 CCDEPMODE = @CCDEPMODE@
 CFLAGS = @CFLAGS@
@@ -139,7 +137,9 @@
 PACKAGE_VERSION = @PACKAGE_VERSION@
 PATH_SEPARATOR = @PATH_SEPARATOR@
 PERL = @PERL@
+PKG_CONFIG = @PKG_CONFIG@
 POSUB = @POSUB@
+REQUIRES_FSPROBE = @REQUIRES_FSPROBE@
 SELINUX_LIBS = @SELINUX_LIBS@
 SELINUX_LIBS_STATIC = @SELINUX_LIBS_STATIC@
 SET_MAKE = @SET_MAKE@
@@ -150,8 +150,6 @@
 USE_NLS = @USE_NLS@
 VERSION = @VERSION@
 VOLID = @VOLID@
-VOLUMEID_LIBS = @VOLUMEID_LIBS@
-VOLUMEID_LIBS_STATIC = @VOLUMEID_LIBS_STATIC@
 XGETTEXT = @XGETTEXT@
 abs_builddir = @abs_builddir@
 abs_srcdir = @abs_srcdir@
@@ -175,6 +173,8 @@
 docdir = @docdir@
 dvidir = @dvidir@
 exec_prefix = @exec_prefix@
+fsprobe_CFLAGS = @fsprobe_CFLAGS@
+fsprobe_LIBS = @fsprobe_LIBS@
 host = @host@
 host_alias = @host_alias@
 host_cpu = @host_cpu@
diff -ur util-linux-ng-2.14.1-rc2-orig/sys-utils/Makefile.in util-linux-ng-2.14.1-rc2/sys-utils/Makefile.in
--- util-linux-ng-2.14.1-rc2-orig/sys-utils/Makefile.in	2008-08-22 13:08:19.000000000 +0200
+++ util-linux-ng-2.14.1-rc2/sys-utils/Makefile.in	2008-09-03 10:34:26.000000000 +0200
@@ -185,8 +185,6 @@
 AUTOMAKE = @AUTOMAKE@
 AWK = @AWK@
 BLKID = @BLKID@
-BLKID_LIBS = @BLKID_LIBS@
-BLKID_LIBS_STATIC = @BLKID_LIBS_STATIC@
 CC = @CC@
 CCDEPMODE = @CCDEPMODE@
 CFLAGS = @CFLAGS@
@@ -232,7 +230,9 @@
 PACKAGE_VERSION = @PACKAGE_VERSION@
 PATH_SEPARATOR = @PATH_SEPARATOR@
 PERL = @PERL@
+PKG_CONFIG = @PKG_CONFIG@
 POSUB = @POSUB@
+REQUIRES_FSPROBE = @REQUIRES_FSPROBE@
 SELINUX_LIBS = @SELINUX_LIBS@
 SELINUX_LIBS_STATIC = @SELINUX_LIBS_STATIC@
 SET_MAKE = @SET_MAKE@
@@ -243,8 +243,6 @@
 USE_NLS = @USE_NLS@
 VERSION = @VERSION@
 VOLID = @VOLID@
-VOLUMEID_LIBS = @VOLUMEID_LIBS@
-VOLUMEID_LIBS_STATIC = @VOLUMEID_LIBS_STATIC@
 XGETTEXT = @XGETTEXT@
 abs_builddir = @abs_builddir@
 abs_srcdir = @abs_srcdir@
@@ -268,6 +266,8 @@
 docdir = @docdir@
 dvidir = @dvidir@
 exec_prefix = @exec_prefix@
+fsprobe_CFLAGS = @fsprobe_CFLAGS@
+fsprobe_LIBS = @fsprobe_LIBS@
 host = @host@
 host_alias = @host_alias@
 host_cpu = @host_cpu@
diff -ur util-linux-ng-2.14.1-rc2-orig/tests/helpers/Makefile.in util-linux-ng-2.14.1-rc2/tests/helpers/Makefile.in
--- util-linux-ng-2.14.1-rc2-orig/tests/helpers/Makefile.in	2008-08-22 13:08:20.000000000 +0200
+++ util-linux-ng-2.14.1-rc2/tests/helpers/Makefile.in	2008-09-03 10:34:26.000000000 +0200
@@ -75,8 +75,6 @@
 AUTOMAKE = @AUTOMAKE@
 AWK = @AWK@
 BLKID = @BLKID@
-BLKID_LIBS = @BLKID_LIBS@
-BLKID_LIBS_STATIC = @BLKID_LIBS_STATIC@
 CC = @CC@
 CCDEPMODE = @CCDEPMODE@
 CFLAGS = @CFLAGS@
@@ -122,7 +120,9 @@
 PACKAGE_VERSION = @PACKAGE_VERSION@
 PATH_SEPARATOR = @PATH_SEPARATOR@
 PERL = @PERL@
+PKG_CONFIG = @PKG_CONFIG@
 POSUB = @POSUB@
+REQUIRES_FSPROBE = @REQUIRES_FSPROBE@
 SELINUX_LIBS = @SELINUX_LIBS@
 SELINUX_LIBS_STATIC = @SELINUX_LIBS_STATIC@
 SET_MAKE = @SET_MAKE@
@@ -133,8 +133,6 @@
 USE_NLS = @USE_NLS@
 VERSION = @VERSION@
 VOLID = @VOLID@
-VOLUMEID_LIBS = @VOLUMEID_LIBS@
-VOLUMEID_LIBS_STATIC = @VOLUMEID_LIBS_STATIC@
 XGETTEXT = @XGETTEXT@
 abs_builddir = @abs_builddir@
 abs_srcdir = @abs_srcdir@
@@ -158,6 +156,8 @@
 docdir = @docdir@
 dvidir = @dvidir@
 exec_prefix = @exec_prefix@
+fsprobe_CFLAGS = @fsprobe_CFLAGS@
+fsprobe_LIBS = @fsprobe_LIBS@
 host = @host@
 host_alias = @host_alias@
 host_cpu = @host_cpu@
diff -ur util-linux-ng-2.14.1-rc2-orig/tests/Makefile.in util-linux-ng-2.14.1-rc2/tests/Makefile.in
--- util-linux-ng-2.14.1-rc2-orig/tests/Makefile.in	2008-08-22 13:08:20.000000000 +0200
+++ util-linux-ng-2.14.1-rc2/tests/Makefile.in	2008-09-03 10:34:26.000000000 +0200
@@ -70,8 +70,6 @@
 AUTOMAKE = @AUTOMAKE@
 AWK = @AWK@
 BLKID = @BLKID@
-BLKID_LIBS = @BLKID_LIBS@
-BLKID_LIBS_STATIC = @BLKID_LIBS_STATIC@
 CC = @CC@
 CCDEPMODE = @CCDEPMODE@
 CFLAGS = @CFLAGS@
@@ -117,7 +115,9 @@
 PACKAGE_VERSION = @PACKAGE_VERSION@
 PATH_SEPARATOR = @PATH_SEPARATOR@
 PERL = @PERL@
+PKG_CONFIG = @PKG_CONFIG@
 POSUB = @POSUB@
+REQUIRES_FSPROBE = @REQUIRES_FSPROBE@
 SELINUX_LIBS = @SELINUX_LIBS@
 SELINUX_LIBS_STATIC = @SELINUX_LIBS_STATIC@
 SET_MAKE = @SET_MAKE@
@@ -128,8 +128,6 @@
 USE_NLS = @USE_NLS@
 VERSION = @VERSION@
 VOLID = @VOLID@
-VOLUMEID_LIBS = @VOLUMEID_LIBS@
-VOLUMEID_LIBS_STATIC = @VOLUMEID_LIBS_STATIC@
 XGETTEXT = @XGETTEXT@
 abs_builddir = @abs_builddir@
 abs_srcdir = @abs_srcdir@
@@ -153,6 +151,8 @@
 docdir = @docdir@
 dvidir = @dvidir@
 exec_prefix = @exec_prefix@
+fsprobe_CFLAGS = @fsprobe_CFLAGS@
+fsprobe_LIBS = @fsprobe_LIBS@
 host = @host@
 host_alias = @host_alias@
 host_cpu = @host_cpu@
diff -ur util-linux-ng-2.14.1-rc2-orig/text-utils/Makefile.in util-linux-ng-2.14.1-rc2/text-utils/Makefile.in
--- util-linux-ng-2.14.1-rc2-orig/text-utils/Makefile.in	2008-08-22 13:08:20.000000000 +0200
+++ util-linux-ng-2.14.1-rc2/text-utils/Makefile.in	2008-09-03 10:34:26.000000000 +0200
@@ -124,8 +124,6 @@
 AUTOMAKE = @AUTOMAKE@
 AWK = @AWK@
 BLKID = @BLKID@
-BLKID_LIBS = @BLKID_LIBS@
-BLKID_LIBS_STATIC = @BLKID_LIBS_STATIC@
 CC = @CC@
 CCDEPMODE = @CCDEPMODE@
 CFLAGS = @CFLAGS@
@@ -171,7 +169,9 @@
 PACKAGE_VERSION = @PACKAGE_VERSION@
 PATH_SEPARATOR = @PATH_SEPARATOR@
 PERL = @PERL@
+PKG_CONFIG = @PKG_CONFIG@
 POSUB = @POSUB@
+REQUIRES_FSPROBE = @REQUIRES_FSPROBE@
 SELINUX_LIBS = @SELINUX_LIBS@
 SELINUX_LIBS_STATIC = @SELINUX_LIBS_STATIC@
 SET_MAKE = @SET_MAKE@
@@ -182,8 +182,6 @@
 USE_NLS = @USE_NLS@
 VERSION = @VERSION@
 VOLID = @VOLID@
-VOLUMEID_LIBS = @VOLUMEID_LIBS@
-VOLUMEID_LIBS_STATIC = @VOLUMEID_LIBS_STATIC@
 XGETTEXT = @XGETTEXT@
 abs_builddir = @abs_builddir@
 abs_srcdir = @abs_srcdir@
@@ -207,6 +205,8 @@
 docdir = @docdir@
 dvidir = @dvidir@
 exec_prefix = @exec_prefix@
+fsprobe_CFLAGS = @fsprobe_CFLAGS@
+fsprobe_LIBS = @fsprobe_LIBS@
 host = @host@
 host_alias = @host_alias@
 host_cpu = @host_cpu@
