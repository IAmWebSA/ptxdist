#
# Submitted-By: Marc Kleine-Budde, 2006-02-09
# Committed-By: Marc Kleine-Budde
#
# Error:
#
# libtool: install: warning: remember to run `libtool --finish /usr/lib'
# cat ./scripts/libpng.pc.in | \
# sed -e 's,[@]PREFIX[@],/usr,' -e 's,[@]INCLUDEDIR[@],/usr/include,' > libpng.pc
# cp libpng.pc libpng12.pc
# /usr/bin/install -c -d /usr/lib/pkgconfig
# /usr/bin/install -c -m 644 libpng.pc /usr/lib/pkgconfig
# /usr/bin/install: cannot remove `/usr/lib/pkgconfig/libpng.pc': Permission denied
# make[2]: *** [install-data-local] Error 1
# make[2]: Leaving directory `/home/mkl/pengutronix/pii/ptxdist-build/build-target/libpng-1.2.8-config'
# make[1]: *** [install-am] Error 2
# make[1]: Leaving directory `/home/mkl/pengutronix/pii/ptxdist-build/build-target/libpng-1.2.8-config'
# make: *** [/home/mkl/pengutronix/pii/ptxdist-build/state/libpng.install] Error 2
#
# Description:
#
# the installation of libpng.pc fails, because DESTDIR is not
# honoured
#
# State:
#
# BUG: 1285794 on libpng's bugtracket on sf.net
#
# bug remains open :(
#
# http://sourceforge.net/tracker/?group_id=5624&atid=105624&func=detail&aid=1285794
#
Index: libpng-1.2.8-config/Makefile.in
===================================================================
--- libpng-1.2.8-config.orig/Makefile.in
+++ libpng-1.2.8-config/Makefile.in
@@ -874,13 +874,13 @@ libpng12.pc: libpng.pc
 	cp libpng.pc libpng12.pc
 
 install-data-local: libpng.pc libpng12.pc
-	@INSTALL@ -d @PKGCONFIGDIR@
-	@INSTALL_DATA@ libpng.pc @PKGCONFIGDIR@
-	@INSTALL_DATA@ libpng12.pc @PKGCONFIGDIR@
+	@INSTALL@ -d $(DESTDIR)@PKGCONFIGDIR@
+	@INSTALL_DATA@ libpng.pc $(DESTDIR)@PKGCONFIGDIR@
+	@INSTALL_DATA@ libpng12.pc $(DESTDIR)@PKGCONFIGDIR@
 
 uninstall-local:
-	rm -f @PKGCONFIGDIR@/libpng.pc
-	rm -f @PKGCONFIGDIR@/libpng12.pc
+	rm -f $(DESTDIR)@PKGCONFIGDIR@/libpng.pc
+	rm -f $(DESTDIR)@PKGCONFIGDIR@/libpng12.pc
 
 libpng-config:
 	( cat ${srcdir}/scripts/libpng-config-head.in; \
