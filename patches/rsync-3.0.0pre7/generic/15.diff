From: Wayne Davison <wayned@samba.org>
Date: Tue, 1 Jan 2008 18:43:55 +0000 (-0800)
Subject: Rebuild the Makefile when it is not up-to-date.
X-Git-Url: http://git.samba.org/?p=rsync.git;a=commitdiff_plain;h=dd6f31f70f2ffd35f48be071c3d831ea4f1e0762

Rebuild the Makefile when it is not up-to-date.
---

diff --git a/Makefile.in b/Makefile.in
index 8594a9d..4716aba 100644
--- a/Makefile.in
+++ b/Makefile.in
@@ -59,7 +59,7 @@ CHECK_OBJS=tls.o getgroups.o getfsdev.o t_stub.o t_unsafe.o trimslash.o wildtest
 	$(CC) -I. -I$(srcdir) $(CFLAGS) $(CPPFLAGS) -c $< @CC_SHOBJ_FLAG@
 @OBJ_RESTORE@
 
-all: conf_stop rsync$(EXEEXT) @MAKE_MAN@
+all: conf_stop make_stop rsync$(EXEEXT) @MAKE_MAN@
 
 install: all
 	-mkdir -p ${DESTDIR}${bindir}
@@ -134,6 +134,13 @@ reconfigure:
 	./config.status --recheck
 	./config.status
 
+make_stop: Makefile
+
+Makefile: Makefile.in config.status
+	@./config.status
+	@echo "Makefile updated -- rerun your make command."
+	@exit 1
+
 proto: proto.h-tstamp
 
 proto.h: proto.h-tstamp

