# 
# Submitted-By: Robert Schwebel, 2005-03-13
# Committed-By: Robert Schwebel
#
# Error: 
#
# MTD utilities forget to use the preprocessor flags; as we feed in
# special include directories via -isystem in PTXdist this is not used
# and crashes. 
#
# Description: 
#
# no public discussion about this topic yet. 
#
# State:
# 
# unknown
#

Index: mtd-utils-1.0.0/Makefile
===================================================================
--- mtd-utils-1.0.0.orig/Makefile
+++ mtd-utils-1.0.0/Makefile
@@ -3,9 +3,10 @@
 
 # $Id: Makefile,v 1.60 2005/11/07 11:15:09 gleixner Exp $
 
-SBINDIR=/usr/sbin
-MANDIR=/usr/man
-INCLUDEDIR=/usr/include
+PREFIX=/usr
+SBINDIR=$(PREFIX)/sbin
+MANDIR=$(PREFIX)/share/man
+INCLUDEDIR=$(PREFIX)/include
 #CROSS=arm-linux-
 CC := $(CROSS)gcc
 CFLAGS := -I./include -O2 -Wall
@@ -24,7 +25,7 @@ SYMLINKS =
 	$(CC) $(LDFLAGS) -g -o $@ $^
 
 %.o: %.c
-	$(CC) $(CFLAGS) -g -c -o $@ $< -g -Wp,-MD,.$<.dep
+	$(CC) $(CFLAGS) $(CPPFLAGS) -g -c -o $@ $< -g -Wp,-MD,.$<.dep
 
 .SUFFIXES:
 
