Subject: [patch] add infrastructure to make tests arch dependend
From: Robert Schwebel <r.schwebel@pengutronix.de>

Propagate host_cpu to Makefiles, in order to make some tests arch
dependend.

FIXME: Patch not finished yet...

Signed-off-by: Robert Schwebel <r.schwebel@pengutronix.de>

---
 configure.ac                   |    6 ++++++
 testcases/realtime/Makefile.in |   16 ++++++++++++++++
 2 files changed, 22 insertions(+)

Index: ltp-full-20090131/configure.ac
===================================================================
--- ltp-full-20090131.orig/configure.ac
+++ ltp-full-20090131/configure.ac
@@ -7,6 +7,8 @@ AC_CONFIG_FILES([config.mk m4/Makefile])
 AC_CANONICAL_BUILD
 AC_CANONICAL_HOST
 
+AC_SUBST(host_cpu)
+
 AC_DEFUN([AC_PROG_AR], [AC_CHECK_TOOL(AR, ar, :)])
 
 AC_PROG_CC
@@ -23,4 +25,8 @@ LTP_CHECK_SYSCALL_EVENTFD
 LTP_CHECK_SYSCALL_MODIFY_LDT
 LTP_CHECK_SYSCALL_SIGNALFD
 
+AC_CONFIG_FILES([
+	testcases/realtime/Makefile
+])
+
 AC_OUTPUT
Index: ltp-full-20090131/testcases/realtime/Makefile.in
===================================================================
--- /dev/null
+++ ltp-full-20090131/testcases/realtime/Makefile.in
@@ -0,0 +1,16 @@
+host_cpu := @host_cpu@
+
+srcdir := .
+include $(srcdir)/config.mk
+
+SUBDIRS = lib func perf stress
+
+all:
+	@set -e; for i in $(SUBDIRS); do $(MAKE) -C $$i; done
+
+install:
+	@set -e; for i in $(SUBDIRS); do $(MAKE) -C $$i install; done
+
+clean:
+	@set -e; for i in $(SUBDIRS); do $(MAKE) -C $$i clean ; done
+	@rm .config
