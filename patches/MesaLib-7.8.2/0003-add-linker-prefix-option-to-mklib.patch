From af051dc63f474c532be558410bc560d67a381003 Mon Sep 17 00:00:00 2001
From: Michael Olbrich <m.olbrich@pengutronix.de>
Date: Wed, 7 Jul 2010 10:57:40 +0200
Subject: [PATCH 3/4] add -linker-prefix option to mklib

On Linux mklib uses gcc or g++ (for C++) as linker. This breaks when
cross-compiling. The "-linker" option cannot be used, because it cannot be
used to specify a differen linker for C and C++.
This patch adds an extra option to add a prefix for the linker command.

Signed-off-by: Michael Olbrich <m.olbrich@pengutronix.de>
---
 bin/mklib |    9 +++++++--
 1 files changed, 7 insertions(+), 2 deletions(-)

diff --git a/bin/mklib b/bin/mklib
index 08ef99e..b922ef1 100755
--- a/bin/mklib
+++ b/bin/mklib
@@ -137,6 +137,7 @@ MINOR=0
 PATCH=""
 DEPS=""
 LINK=""
+LINK_PREFIX=""
 LDFLAGS=""
 CPLUSPLUS=0
 STATIC=0
@@ -178,6 +179,10 @@ do
 	    shift 1;
 	    LINK=$1
 	    ;;
+	'-linker-prefix')
+	    shift 1;
+	    LINK_PREFIX=$1
+	    ;;
 	'-ldflags')
 	    shift 1;
 	    LDFLAGS=$1
@@ -313,9 +318,9 @@ case $ARCH in
 	if [ "x$LINK" = "x" ] ; then
 	    # -linker was not specified so set default link command now
             if [ $CPLUSPLUS = 1 ] ; then
-                LINK=g++
+                LINK=${LINK_PREFIX}g++
             else
-                LINK=gcc
+                LINK=${LINK_PREFIX}gcc
             fi
 	fi
 
-- 
1.7.1

