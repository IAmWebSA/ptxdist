#
# http://gcc.gnu.org/ml/gcc-bugs/2003-06/msg01479.html
#
# http://gcc.gnu.org/bugzilla/attachment.cgi?id=4208&action=view
#
diff -ruN binutils-2.14.orig/gas/config/tc-arm.c binutils-2.14/gas/config/tc-arm.c
diff -ru binutils-2.14.orig/gas/config/tc-arm.c binutils-2.14/gas/config/tc-arm.c
--- binutils-2.14.orig/gas/config/tc-arm.c	2003-04-03 01:31:25.000000000 +0200
+++ binutils-2.14/gas/config/tc-arm.c	2004-03-29 00:21:12.000000000 +0200
@@ -134,6 +134,19 @@
 #endif
 #endif
 
+#ifdef TE_LINUX
+#define FPU_DEFAULT FPU_ARCH_FPA
+#endif
+
+#ifdef TE_NetBSD
+#ifdef OBJ_ELF
+#define FPU_DEFAULT FPU_ARCH_VFP	/* Soft-float, but VFP order.  */
+#else
+/* Legacy a.out format.  */
+#define FPU_DEFAULT FPU_ARCH_FPA	/* Soft-float, but FPA order.  */
+#endif
+#endif
+
 /* For backwards compatibility we default to the FPA.  */
 #ifndef FPU_DEFAULT
 #define FPU_DEFAULT FPU_ARCH_FPA
@@ -10185,10 +10198,16 @@
     }
   else if (mfpu_opt == -1)
     {
+#if !(defined (TE_LINUX) || defined (TE_NetBSD))
+      /* Some environments specify a default FPU.  If they don't, infer it
+	 from the processor.  */
       if (mcpu_fpu_opt != -1)
 	mfpu_opt = mcpu_fpu_opt;
       else
 	mfpu_opt = march_fpu_opt;
+#else
+      mfpu_opt = FPU_DEFAULT;
+#endif
     }
 
   if (mfpu_opt == -1)
