#
# rules/kernel.in
#

##############################################################################
menu "Kernel              "
##############################################################################

config USE_EXTERNAL_KERNEL
	bool
	prompt "Use external kernel"
	default n
	help
	  Say yes if you intend to use an external already configured 
	  kernel tree. You want this if you, for example, are currently
	  working in a kernel tree and don't want to generate patches 
	  for each and every PTXdist run. 

config KERNEL_DIR
	string
	prompt "Path to external kernel source"
	depends on USE_EXTERNAL_KERNEL
	help
	  Add a path to your external kernel here. The kernel must be
	  configured. 

config KERNEL_CONFIG
	string
	prompt "Path to kernel .config file"
	depends on !USE_EXTERNAL_KERNEL
	help
	  Usually config files for the kernel live in $(PROJECTDIR), so
	  add something like

		$(PROJECTDIR)/your-kernelconfig.kernelconfig 

	  here.


config KERNEL_2_4
	bool

config KERNEL_2_4_COMPILE
	bool
	depends on !DONT_COMPILE_KERNEL
	default y if KERNEL_2_4
	select HOSTTOOL_MODUTILS


config KERNEL_2_6
	bool

config KERNEL_2_6_COMPILE
	bool
	depends on !DONT_COMPILE_KERNEL
	default y if KERNEL_2_6
	select HOSTTOOL_MODULE_INIT_TOOLS


choice 
	prompt "Kernel Version"
		default KERNEL_2_6_10
		depends on !USE_EXTERNAL_KERNEL

	config KERNEL_2_4_19
		bool
		prompt "2.4.19"
		select KERNEL_2_4
 
	config KERNEL_2_4_20
		bool
		prompt "2.4.20"
		depends on ARCH_ARM_NOMMU || ARCH_X86 || ARCH_PPC || ARCH_SPARC || ARCH_MIPS || ARCH_CRIS || ARCH_PARISC || ARCH_SH
		select KERNEL_2_4

	config KERNEL_2_4_21
		bool
		prompt "2.4.21"
		select KERNEL_2_4

	config KERNEL_2_4_22
		bool
		prompt "2.4.22"
		depends on ARCH_ARM_NOMMU || ARCH_X86 || ARCH_PPC || ARCH_SPARC || ARCH_MIPS || ARCH_CRIS || ARCH_PARISC || ARCH_SH
		select KERNEL_2_4

	config KERNEL_2_4_23
		bool
		prompt "2.4.23"
		depends on ARCH_X86 || ARCH_PPC || ARCH_SPARC || ARCH_MIPS || ARCH_CRIS || ARCH_PARISC || ARCH_SH
		select KERNEL_2_4

	config KERNEL_2_4_25
		bool
		prompt "2.4.25"
		depends on ARCH_X86 || ARCH_ARM
		select KERNEL_2_4

	config KERNEL_2_4_26
		bool
		prompt "2.4.26"
		depends on ARCH_X86 || ARCH_ARM || ARCH_ALPHA
		select KERNEL_2_4

	config KERNEL_2_4_27
		bool
		prompt "2.4.27"
		depends on ARCH_X86 || ARCH_ARM || ARCH_ARM_NOMMU
		select KERNEL_2_4

	config KERNEL_2_6_0
		bool
		prompt "2.6.0"
		depends on ARCH_X86 || ARCH_ARM
		select KERNEL_2_6
	
	config KERNEL_2_6_1
		bool
		prompt "2.6.1"
		depends on ARCH_X86 || ARCH_ARM || ARCH_ALPHA
		select KERNEL_2_6

	config KERNEL_2_6_6
		bool
		prompt "2.6.6"
		depends on ARCH_X86 || ARCH_ARM || ARCH_ALPHA
		select KERNEL_2_6
	
	config KERNEL_2_6_7
		bool
		prompt "2.6.7"
		depends on ARCH_X86 || ARCH_ARM || ARCH_PPC || ARCH_ALPHA
		select KERNEL_2_6

	config KERNEL_2_6_8
		bool
		prompt "2.6.8"
		depends on ARCH_X86 || ARCH_ARM || ARCH_PPC || ARCH_ALPHA
		select KERNEL_2_6

	config KERNEL_2_6_9
		bool
		prompt "2.6.9"
		depends on ARCH_X86 || ARCH_ARM || ARCH_PPC || ARCH_ALPHA
		select KERNEL_2_6

	config KERNEL_2_6_10
		bool
		prompt "2.6.10"
		depends on ARCH_X86 || ARCH_ARM
		select KERNEL_2_6

	config KERNEL_2_6_11
		bool
		prompt "2.6.11"
		depends on ARCH_X86 || ARCH_ARM
		select KERNEL_2_6

endchoice

config DONT_COMPILE_KERNEL
	bool
	prompt "Don't compile kernel"
	default n

choice
	prompt "Kernel Image"
	default KERNEL_IMAGE_BZ
	depends on !DONT_COMPILE_KERNEL || KERNEL_INSTALL

	config KERNEL_IMAGE_BZ
		bool
		prompt "bzImage"
		depends on ARCH_X86
		
	config KERNEL_IMAGE_Z
		bool
		prompt "zImage"
		depends on ARCH_X86 || ARCH_ARM

	config KERNEL_IMAGE_U
		bool
		prompt "uImage"
		depends on ARCH_ARM || ARCH_X86 || ARCH_PPC

	config KERNEL_IMAGE_VMLINUX
		bool
		prompt "vmlinux"
endchoice

config KERNEL_INSTALL
	bool
	prompt "Install kernel into /boot on target"
	default n
	select KERNEL_INSTALL_MODULES if !DONT_COMPILE_KERNEL

config KERNEL_INSTALL_MODULES
	bool
	prompt "Install modules into /lib/modules on target"
	default n 

# ----------------------------------------------------------------------------
# Generic Patch Stack
# ----------------------------------------------------------------------------

comment ""

config KERNEL_PATCH1_URL
	prompt "Patch 1 URL"
	string
	depends on !USE_EXTERNAL_KERNEL
	help
	  Enter a URL to a diff/patch file or to a directory containing
	  a patch tree for patcher here. 

config KERNEL_PATCH1_NAME
	prompt "Patch 1 Name"
	depends on !USE_EXTERNAL_KERNEL
	string

comment ""
	depends on KERNEL_PATCH1_URL!=""

config KERNEL_PATCH2_URL
	prompt "Patch 2 URL"
	string
	depends on KERNEL_PATCH1_URL!=""
	help
	  Enter a URL to a diff/patch file or to a directory containing
	  a patch tree for patcher here. 

config KERNEL_PATCH2_NAME
	prompt "Patch 2 Name"
	string
	depends on KERNEL_PATCH1_URL!=""

comment ""
	depends on KERNEL_PATCH2_URL!=""

config KERNEL_PATCH3_URL
	prompt "Patch 3 URL"
	string
	depends on KERNEL_PATCH2_URL!=""
	help
	  Enter a URL to a diff/patch file or to a directory containing
	  a patch tree for patcher here. 

config KERNEL_PATCH3_NAME
	prompt "Patch 3 Name"
	string
	depends on KERNEL_PATCH2_URL!=""

comment ""
	depends on KERNEL_PATCH3_URL!=""

config KERNEL_PATCH4_URL
	prompt "Patch 4 URL"
	string
	depends on KERNEL_PATCH3_URL!=""
	help
	  Enter a URL to a diff/patch file or to a directory containing
	  a patch tree for patcher here. 

config KERNEL_PATCH4_NAME
	prompt "Patch 4 Name"
	string
	depends on KERNEL_PATCH3_URL!=""

comment ""
	depends on KERNEL_PATCH4_URL!=""

config KERNEL_PATCH5_URL
	prompt "Patch 5 URL"
	string
	depends on KERNEL_PATCH4_URL!=""
	help
	  Enter a URL to a diff/patch file or to a directory containing
	  a patch tree for patcher here. 

config KERNEL_PATCH5_NAME
	prompt "Patch 5 Name"
	string
	depends on KERNEL_PATCH4_URL!=""

comment ""
	depends on KERNEL_PATCH5_URL!=""

config KERNEL_PATCH6_URL
	prompt "Patch 6 URL"
	string
	depends on KERNEL_PATCH5_URL!=""
	help
	  Enter a URL to a diff/patch file or to a directory containing
	  a patch tree for patcher here. 

config KERNEL_PATCH6_NAME
	prompt "Patch 6 Name"
	string
	depends on KERNEL_PATCH6_URL!=""

comment ""
	depends on KERNEL_PATCH6_URL!=""

config KERNEL_PATCH7_URL
	prompt "Patch 7 URL"
	string
	depends on KERNEL_PATCH6_URL!=""
	help
	  Enter a URL to a diff/patch file or to a directory containing
	  a patch tree for patcher here. 

config KERNEL_PATCH7_NAME
	prompt "Patch 7 Name"
	string
	depends on KERNEL_PATCH6_URL!=""

comment ""
	depends on KERNEL_PATCH7_URL!=""

config KERNEL_PATCH8_URL
	prompt "Patch 8 URL"
	string
	depends on KERNEL_PATCH7_URL!=""
	help
	  Enter a URL to a diff/patch file or to a directory containing
	  a patch tree for patcher here. 

config KERNEL_PATCH8_NAME
	prompt "Patch 8 Name"
	string
	depends on KERNEL_PATCH8_URL!=""

comment ""
	depends on KERNEL_PATCH8_URL!=""

config KERNEL_PATCH9_URL
	prompt "Patch 9 URL"
	string
	depends on KERNEL_PATCH8_URL!=""
	help
	  Enter a URL to a diff/patch file or to a directory containing
	  a patch tree for patcher here. 

config KERNEL_PATCH9_NAME
	prompt "Patch 9 Name"
	string
	depends on KERNEL_PATCH8_URL!=""

comment ""
	depends on KERNEL_PATCH9_URL!=""

config KERNEL_PATCH10_URL
	prompt "Patch 10 URL"
	string
	depends on KERNEL_PATCH9_URL!=""
	help
	  Enter a URL to a diff/patch file or to a directory containing
	  a patch tree for patcher here. 

config KERNEL_PATCH10_NAME
	prompt "Patch 10 Name"
	string
	depends on KERNEL_PATCH9_URL!=""

comment ""
	depends on KERNEL_PATCH10_URL!=""

# ----------

comment "Extentions"

comment "epoll should be ported to patchstack mechanism, please send patch! :-)"
#source "rules/epoll.in"

source "rules/rtai.in"

endmenu

