##############################################################################
comment "Image Creation for Target"
##############################################################################

config IMAGE_TGZ
	bool
	prompt "Generate images/root.tgz"
	help
	  Build a tar.gz archive of the root filesystem, containing the
	  right owner/group and access permissions.

config IMAGE_HD
	bool
	select IMAGE_EXT2
	prompt "Generate images/hd.img"
	help
	  General
	  -------

	  Build a harddisk root image. The image will contain a partition table
	  which you can define with the following entries. Note that the resulting
	  partition table does not have CHS entries but only LBA entries, so
	  you need to switch your (x86-) Bios to LBA. Also note that fdisk will
	  complain about inconsistent CHS/LBA entries. You can ignore these warnings.
	  The ptxdist image will be put into the first partition.

	  Partition sizes
	  ---------------

	  You can define a partition by giving the first and the last sector of
	  each partition. Sectors are units of 512 bytes. The first sector (sector 0)
	  is reserved for the MBR and the partition table.
	  Sectors can be given either decimal or in hex prefixed with 0x.
	  Beware that a 256MB flash card does not have exactly 256 * 1024 * 2 sectors
	  but slightly less.

	  Partition types
	  ---------------

	  You can give the partition types as a decimal or hex (prefixed with 0x) value
	  See at the output of "sfdisk -T" for a list of valid types. No extended
	  partitions are supported at the moment.

	  grub
	  ----

	  If you select grub in your config, it will be installed on the image and thus
	  give a bootable image for x86 PCs. The grub stage2 file will be installed right
	  after the MBR before the first partition, so you need to leave a hole before the
	  first partition. Starting the partition on sector 300 should be a safe value.

config IMAGE_HD_PART1
	bool
	default y
	depends on IMAGE_HD

config IMAGE_HD_PART1_START
	string
	depends on IMAGE_HD
	prompt "partition 1 start sector"
	help
	  see Generate images/hd.img

config IMAGE_HD_PART1_END
	string
	depends on IMAGE_HD
	prompt "partition 1 end sector"
	help
	  see Generate images/hd.img

config IMAGE_HD_PART1_TYPE
	string
	default "0x83"
	depends on IMAGE_HD_PART1
	prompt "partition 1 type"
	help
	  see Generate images/hd.img

config IMAGE_HD_PART2
	bool
	depends on IMAGE_HD
	prompt "Create partition 2"

config IMAGE_HD_PART2_START
	string
	depends on IMAGE_HD_PART2
	prompt "partition 2 start sector"
	help
	  see Generate images/hd.img

config IMAGE_HD_PART2_END
	string
	depends on IMAGE_HD_PART2
	prompt "partition 2 end sector"
	help
	  see Generate images/hd.img

config IMAGE_HD_PART2_TYPE
	string
	default "0x83"
	depends on IMAGE_HD_PART2
	prompt "partition 2 type"
	help
	  see Generate images/hd.img

config IMAGE_HD_PART3
	bool
	depends on IMAGE_HD_PART2
	prompt "Create partition 3"

config IMAGE_HD_PART3_START
	string
	depends on IMAGE_HD_PART3
	prompt "partition 3 start sector"
	help
	  see Generate images/hd.img

config IMAGE_HD_PART3_END
	string
	depends on IMAGE_HD_PART3
	prompt "partition 3 end sector"
	help
	  see Generate images/hd.img

config IMAGE_HD_PART3_TYPE
	string
	default "0x83"
	depends on IMAGE_HD_PART3
	prompt "partition 3 type"
	help
	  see Generate images/hd.img

config IMAGE_HD_PART4
	bool
	depends on IMAGE_HD_PART3
	prompt "Create partition 4"

config IMAGE_HD_PART4_START
	string
	depends on IMAGE_HD_PART4
	prompt "partition 4 start sector"
	help
	  see Generate images/hd.img

config IMAGE_HD_PART4_END
	string
	depends on IMAGE_HD_PART4
	prompt "partition 4 end sector"
	help
	  see Generate images/hd.img

config IMAGE_HD_PART4_TYPE
	string
	default "0x83"
	depends on IMAGE_HD_PART4
	prompt "partition 4 type"
	help
	  see Generate images/hd.img

config IMAGE_IPKG_IMAGE_FROM_REPOSITORY
	bool
	prompt "make images: use packets from repository"
	help
	  Usually 'make images' packages the files from ${IMAGEDIR}
	  into ${IMAGEDIR}/root.[filesystem]. If this option is checked the
	  packet files from the IPKG update site (to be specified in
	  .ptxdistrc) are taken instead.

config IMAGE_IPKG_EXTRA_ARGS
	string
	default ""
	prompt "extra arguments passed to ipkg-build"
	help
	  If needed you can add extra arguments for ipkg-build here
	  (e.g. -c if you want ipkg-build to use tar instead of ar.)

config IMAGE_IPKG_ARCH
	string
	default "${PTXCONF_ARCH}"
	prompt "Name for ipkg field 'Architecture:'"
	help
	  You can specify an architecture name for your ipkg packets here, e.g.
	  ${PTXCONF_PROJECT}. Default is ${PTXCONF_ARCH}. Another option would
	  be to fix this to the PTXdist version you are using; think of
	  PTXdist being a distro development tool ("Build with ptxdist-0.8.15").

config IMAGE_JFFS2
	bool
	select HOST_MTD_UTILS
	prompt "Generate images/root.jffs2"
	help
	  Build a jffs2 image of the root filesystem. This image can be stored
	  linearly into target's flash device at the start of the desired
	  partition. You should erase the whole partition first if the image
	  is smaller than partition's size. If not, garbage data in the remaining
	  space could confuse the filesystem driver.

config IMAGE_JFFS2_BLOCKSIZE
	int
	default -1
	prompt "Erase Block Size"
	depends on IMAGE_JFFS2
	help
	  Enter here the size of each (sector) block in target's flash device.
	  The image must use the same blocksize as the real JFFS2 filesystem
	  running on the target.

config IMAGE_JFFS2_EXTRA_ARGS
	string
	default ""
	prompt "extra arguments passed to mkfs.jffs2"
	depends on IMAGE_JFFS2
	help
	  If needed you can add extra arguments for mkfs.jffs2 here
	  (e.g. --devtable=${PTXDIST_WORKSPACE}/device_table.txt or
	  -b to create a big endian filesystem on a little endian host)

config IMAGE_UIMAGE
	bool
	prompt "Generate images/uRamdisk"
	select HOST_UMKIMAGE
	select IMAGE_EXT2
	select IMAGE_EXT2_GZIP
	help
	  The file images/uRamdisk can be loaded by the bootloader U-Boot

config IMAGE_UIMAGE_NAME
	string
	default "Application Ramdisk"
	prompt "name of the ramdisk image"
	depends IMAGE_UIMAGE
	help
	  FIXME: This item needs to be documented

config IMAGE_UIMAGE_EXTRA_ARGS
	string
	default ""
	prompt "extra arguments passed to umkimage"
	depends on IMAGE_UIMAGE
	help
	  If needed you can add extra arguments for umkimage here
	  (e.g. -a 0xaa00000 -e 0xaa00000 )

config IMAGE_EXT2
	bool
	select HOST_GENEXT2FS
	prompt "Generate images/root.ext2"
	help
	  Build an ext2 image of the root filesystem

config IMAGE_EXT2_SIZE
	int
	default 20480
	prompt "Size in kilobytes"
	depends on IMAGE_EXT2
	help
	  FIXME: This item needs to be documented

config IMAGE_EXT2_EXTRA_ARGS
	string
	default ""
	prompt "extra arguments passed to genext2fs"
	depends on IMAGE_EXT2
	help
	  If needed you can add extra arguments for genext2fs here
	  (e.g. -U -r 0 -D=${PTXDIST_WORKSPACE}/device_table.txt)

config IMAGE_EXT2_GZIP
	bool
	prompt "Compress the image using gzip"
	depends on IMAGE_EXT2
	help
	  FIXME: This item needs to be documented

